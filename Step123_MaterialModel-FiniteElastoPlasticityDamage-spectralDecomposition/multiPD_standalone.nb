(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    240135,       4911]
NotebookOptionsPosition[    235453,       4822]
NotebookOutlinePosition[    236231,       4845]
CellTagsIndexPosition[    236188,       4842]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Step123\[LetterSpace]MaterialModel-FiniteElastoPlasticityDamage-\
spectralDecomposition - multiPD\
\>", "Title",
 CellChangeTimes->{{3.877665521357202*^9, 3.87766552148142*^9}, 
   3.87776301672014*^9, {3.959941344745088*^9, 
   3.959941403121645*^9}},ExpressionUUID->"f9299cf0-f2f0-4543-a424-\
0cdfff049f23"],

Cell["\<\
content :
 - material model
- multiplicative plasticity
- spectral decomposition
- eigenvalues
- modular concept
- coupled damage
- SMSInitialize, SMSModule, SMSD, SMSDo, SMSCall
- AceGen building time : ~50 s (Mode : Debug), ~140 s (Mode : Optimal)\
\>", "Abstract",
 CellChangeTimes->{{3.877665521357202*^9, 3.87766552148142*^9}, 
   3.87776301672014*^9, {3.959941344745088*^9, 3.9599413613333187`*^9}, {
   3.959941407784816*^9, 3.9599414382764883`*^9}, {3.9599414933795013`*^9, 
   3.959941525617023*^9}},ExpressionUUID->"3a924117-3a5d-4d40-88e5-\
e75bd695b5fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Evaluate", " ", "before", " ", "starting", " ", "writing", " ", 
    "\"\<real code\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Usage", " ", 
     RowBox[{"e", ".", "g", "."}]}], ":", " ", 
    RowBox[{
    "typing", " ", "\"\<ld [Spacekey]\>\"", " ", "becomes", " ", 
     "\"\<\[DoubleRightTee]\>\""}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{
     RowBox[{"EvaluationNotebook", "[", "]"}], ",", " ", "\n", " ", 
     RowBox[{"InputAutoReplacements", " ", "->", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<ld\>\"", "\[Rule]", " ", "\"\<\[DoubleRightTee]\>\""}], 
        ",", 
        RowBox[{"\"\<ls\>\"", "\[Rule]", "\"\<\[RightTee]\>\""}], ",", 
        RowBox[{"\"\<rd\>\"", "\[Rule]", "\"\<\[DoubleLeftTee]\>\""}], ",", 
        RowBox[{"\"\<rs\>\"", "\[Rule]", "\"\<\[LeftTee]\>\""}], ",", 
        RowBox[{"\"\<dbl\>\"", "\[Rule]", "\"\<\[LeftDoubleBracket]\>\""}], 
        ",", 
        RowBox[{"\"\<dbr\>\"", "\[Rule]", "\"\<\[RightDoubleBracket]\>\""}], 
        ",", 
        RowBox[{"\"\<->\>\"", "\[Rule]", "\"\<\[Rule]\>\""}], ",", 
        RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\[LetterSpace]\>\""}], ",", 
        RowBox[{"\"\<co\>\"", "\[Rule]", "\"\<(*\>\""}], ",", 
        RowBox[{"\"\<cc\>\"", "\[Rule]", "\"\<*)\>\""}], ",", 
        RowBox[{"\"\<lcb\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
        RowBox[{"\"\<rcb\>\"", "\[Rule]", "\"\<}\>\""}], ",", 
        RowBox[{"\"\<lsb\>\"", "\[Rule]", "\"\<[\>\""}], ",", 
        RowBox[{"\"\<rsb\>\"", "\[Rule]", "\"\<]\>\""}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", "Now", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "To", " ", "know", " ", "when", " ", "AceGen", " ", "has", " ", "been", 
     " ", "executed", " ", "the", " ", "last", " ", "time"}], " ", 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.877665521357202*^9, 3.87766552148142*^9}, 
   3.87776301672014*^9, {3.959941344745088*^9, 3.959941345410273*^9}, {
   3.959941788218444*^9, 3.95994179341004*^9}, {3.960336371320013*^9, 
   3.960336387509035*^9}},
 CellLabel->
  "In[421]:=",ExpressionUUID->"2cfd6946-f75b-418a-99fe-c683b8640bec"],

Cell[BoxData[
 TemplateBox[{
   RowBox[{"\"Tue 1 Jul 2025 07:58:40\"", 
     StyleBox[
      RowBox[{"\"GMT+\"", "\[InvisibleSpace]", 
        StyleBox["2", NumberMarks -> False, StripOnInput -> False]}], 
      FontColor -> GrayLevel[0.5]]}], 
   RowBox[{"DateObject", "[", 
     RowBox[{
       RowBox[{"{", 
         RowBox[{
          "2025", ",", "7", ",", "1", ",", "7", ",", "58", ",", 
           "40.666994`8.361817049905452"}], "}"}], ",", "\"Instant\"", ",", 
       "\"Gregorian\"", ",", "2.`"}], "]"}]},
  "DateObject",
  Editable->False]], "Output",
 CellChangeTimes->{
  3.959414407157797*^9, 3.959811440681964*^9, 3.959811883816576*^9, 
   3.959812045188677*^9, 3.959812098688163*^9, 3.959812202456991*^9, 
   3.9598122346999483`*^9, 3.9598123653273497`*^9, 3.9598126758656273`*^9, 
   3.959812773659783*^9, 3.9598128255955153`*^9, {3.959812944105073*^9, 
   3.959812952707589*^9}, 3.959813038668023*^9, 3.959813291700301*^9, 
   3.9598133471372766`*^9, 3.959813440977518*^9, 3.959813719781678*^9, 
   3.959813837496933*^9, {3.959813904134753*^9, 3.959813914919128*^9}, 
   3.959814018445859*^9, 3.959814224840411*^9, 3.959814309188587*^9, 
   3.959814537660036*^9, 3.959814583815033*^9, 3.95981469718242*^9, 
   3.959814764881102*^9, {3.959814939112831*^9, 3.959814955721553*^9}, 
   3.959815105993145*^9, 3.959815378382226*^9, 3.959815440102162*^9, 
   3.959815490054504*^9, 3.959815637248747*^9, 3.959815718223073*^9, 
   3.959815752265441*^9, 3.959815927788557*^9, 3.9598160270322037`*^9, {
   3.9598161058094378`*^9, 3.959816135338512*^9}, 3.959816178160594*^9, 
   3.959816323347315*^9, 3.9598165691038637`*^9, 3.9598167491293507`*^9, 
   3.959817791855382*^9, 3.959818226112982*^9, 3.959820825816414*^9, 
   3.959820970086094*^9, 3.9598211645683327`*^9, 3.959821439881419*^9, 
   3.959821845130213*^9, 3.959824423623786*^9, 3.959826879177227*^9, 
   3.959833841705473*^9, 3.959852216590117*^9, 3.9598523263616247`*^9, 
   3.959936218640502*^9, 3.959936439411769*^9, 3.959936923580839*^9, 
   3.959937557956419*^9, 3.959937695182583*^9, 3.9599412405230637`*^9, 
   3.959941443329522*^9, 3.959941499548203*^9, 3.960330569920993*^9, {
   3.960330615525899*^9, 3.960330638159006*^9}, 3.960330685932684*^9, 
   3.9603307534374228`*^9, 3.960331037919323*^9, 3.960331177255589*^9, 
   3.9603316496390142`*^9, 3.9603317532934017`*^9, 3.960331826112288*^9, 
   3.960331942917584*^9, 3.960332023454146*^9, 3.96033210188177*^9, 
   3.960332287348177*^9, 3.960332378658012*^9, 3.9603325304420557`*^9, 
   3.960333242966523*^9, 3.960333516740958*^9, {3.960333633659659*^9, 
   3.96033364470348*^9}, 3.960334009358943*^9, 3.960334294503336*^9, 
   3.960334414722249*^9, {3.960334476619437*^9, 3.960334491577154*^9}, 
   3.9603347203795977`*^9, 3.960334878468046*^9, 3.9603349620589533`*^9, 
   3.96033529830424*^9, 3.9603353829007587`*^9, 3.9603354898488283`*^9, 
   3.960335681316359*^9, 3.960335789441463*^9, 3.960336033979124*^9, 
   3.960337727287999*^9, 3.960337963473949*^9, 3.960338131200405*^9, 
   3.960338320669589*^9},
 CellLabel->
  "Out[422]=",ExpressionUUID->"6ae4786b-ffc8-4f2f-80b7-70933f6d8d77"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "initialisation", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "all", " ", "variables", " ", "are", " ", "initially", " ", "cleared"}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "AceGen`"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"AceGen", " ", "is", " ", "started"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "subroutine\[LetterSpace]NAME", " ", "=", " ", "\"\<multiPD\>\""}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "name", " ", "of", " ", "the", " ", "AceGen", " ", "session", " ", 
      "\"\<subroutine\[LetterSpace]NAME\>\"", " ", "can", " ", "be", " ", 
      "specified"}], ",", " ", 
     RowBox[{
      RowBox[{"Programming", " ", 
       RowBox[{"language", ":", " ", 
        RowBox[{
         RowBox[{"Fortran", "/", "Matlab"}], "/", 
         RowBox[{"C", "++"}]}]}]}], "/.", ".."}], ",", " ", 
     RowBox[{"Mode", ":", " ", 
      RowBox[{
       RowBox[{"Debug", "/", "Prototype"}], "/", "Optimal"}]}]}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SMSInitialize", "[", 
     RowBox[{"subroutine\[LetterSpace]NAME", ",", 
      RowBox[{"\"\<Language\>\"", "\[Rule]", " ", "\"\<Matlab\>\""}], ",", 
      RowBox[{"\"\<Mode\>\"", "\[Rule]", " ", "\"\<Optimal\>\""}]}], "]"}], 
    ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TESTING", " ", "=", " ", "False"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"True", ":", " ", 
       RowBox[{
       "Uses", " ", "no", " ", "SMSD", " ", "and", " ", "returns", " ", "no", 
        " ", "output"}]}], ";", " ", 
      RowBox[{"False", ":", " ", 
       RowBox[{
       "Full", " ", "derivation", " ", "including", " ", "SMSD", " ", "and", 
        " ", "output"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
    "build\[LetterSpace]UMAT\[LetterSpace]LSD", " ", "=", " ", "True"}], ";", 
    " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Changes", " ", "the", " ", "type", " ", "of", " ", "output", " ", 
      "tangent", " ", "to", " ", "Eulerian"}], " ", "*)"}], " ", 
    "\[IndentingNewLine]", 
    RowBox[{
    "compile\[LetterSpace]with\[LetterSpace]debugging\[LetterSpace]\
conditionals", " ", "=", " ", "True"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "For", " ", "the", " ", "final", " ", "production", " ", "code", " ", 
      "this", " ", "option", " ", "can", " ", "be", " ", "set", " ", "to", 
      " ", "False"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"USER", "-", "parameters"}], " ", "*)"}], " ", 
    "\[IndentingNewLine]", "  ", 
    RowBox[{
    "local\[LetterSpace]convergence\[LetterSpace]tolerance\[LetterSpace]\
absolute", " ", "=", " ", "1*^-6"}], ";"}], "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"n\[LetterSpace]subiterations", "=", "25"}], ";"}], 
   "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"n\[LetterSpace]iterations\[LetterSpace]lineSearch", "=", "15"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"plasticity", "-", 
       RowBox[{"damage", " ", 
        RowBox[{
        "coupling", ":", "\[IndentingNewLine]", "m\[LetterSpace]EFS"}]}]}], 
      "=", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "&"}], "m\[LetterSpace]ESP"}], "=", 
       RowBox[{"0", ":", " ", 
        RowBox[{
        "degrade", " ", "the", " ", "flow", " ", "stress", " ", "to", " ", 
         "zero", " ", "with", " ", "damage"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"m\[LetterSpace]EFS", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"0", "&"}], "m\[LetterSpace]ESP"}], "=", 
       RowBox[{"1", ":", " ", 
        RowBox[{
        "increase", " ", "the", " ", "effective", " ", "von", " ", "Mises", 
         " ", "stress", " ", "to", " ", "infinity", " ", "with", " ", 
         "damage"}]}]}]}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m\[LetterSpace]EFS", " ", "=", " ", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m\[LetterSpace]ESP", " ", "=", " ", "0"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413737500931*^9}, {3.9594144559111023`*^9, 
   3.9594145771414433`*^9}, {3.959414611113225*^9, 3.959414705729742*^9}, {
   3.9594147558803062`*^9, 3.959414970422175*^9}, {3.959415014276359*^9, 
   3.9594151211315536`*^9}, {3.959415154042604*^9, 3.959415217163155*^9}, {
   3.959415251002194*^9, 3.959415510058682*^9}, {3.9594155749785633`*^9, 
   3.9594156917892923`*^9}, {3.959415734369328*^9, 3.9594158717082653`*^9}, {
   3.959417094189485*^9, 3.9594172123084583`*^9}, {3.9598106957923813`*^9, 
   3.9598107354250298`*^9}, {3.959810820128303*^9, 3.95981086766051*^9}, {
   3.959811513771495*^9, 3.959811514575712*^9}, {3.959811563867221*^9, 
   3.959811605018972*^9}, {3.959811646571168*^9, 3.9598116466431293`*^9}, {
   3.959811683059569*^9, 3.9598117029717197`*^9}, {3.959811747655061*^9, 
   3.9598118224208183`*^9}, 3.959811876630066*^9, 3.95981209641258*^9, {
   3.9598121787079906`*^9, 3.9598121917499647`*^9}, 3.959812350986835*^9, {
   3.959812428839019*^9, 3.959812442038455*^9}, 3.959812560931497*^9, {
   3.959812612310029*^9, 3.959812612645423*^9}, {3.95981285293437*^9, 
   3.959812859822528*^9}, 3.959812939199499*^9, {3.9598157153787203`*^9, 
   3.959815740042719*^9}, {3.959815926163641*^9, 3.9598159267384167`*^9}, {
   3.959816315193218*^9, 3.959816318907012*^9}, {3.95981674198857*^9, 
   3.9598167428201942`*^9}, {3.95982687198333*^9, 3.959826878031083*^9}, {
   3.9598520357677393`*^9, 3.959852038388694*^9}, {3.959852224356079*^9, 
   3.9598522248856792`*^9}, {3.9599364244643297`*^9, 3.959936426352377*^9}, {
   3.959939790869549*^9, 3.959939861766691*^9}, {3.9599398959749517`*^9, 
   3.959939898454671*^9}, {3.959939930831235*^9, 3.959940003726927*^9}, {
   3.9599414415444117`*^9, 3.959941442092822*^9}, {3.959941497375763*^9, 
   3.9599414981659393`*^9}, {3.959941764899472*^9, 3.959941786259694*^9}, 
   3.9603308167577868`*^9, 3.960336032716818*^9, {3.960338316902269*^9, 
   3.9603383459291553`*^9}},ExpressionUUID->"8844cf92-f4b2-4d5e-bb00-\
3725bcd312d2"],

Cell[CellGroupData[{

Cell["Tensor functions", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413737500931*^9}, {3.9594144559111023`*^9, 
   3.9594145771414433`*^9}, {3.959414611113225*^9, 3.959414705729742*^9}, {
   3.9594147558803062`*^9, 3.959414970422175*^9}, {3.959415014276359*^9, 
   3.9594151211315536`*^9}, {3.959415154042604*^9, 3.959415217163155*^9}, {
   3.959415251002194*^9, 3.959415510058682*^9}, {3.9594155749785633`*^9, 
   3.9594156917892923`*^9}, {3.959415734369328*^9, 3.9594158717082653`*^9}, {
   3.959417094189485*^9, 3.9594172123084583`*^9}, {3.9598106957923813`*^9, 
   3.9598107354250298`*^9}, {3.959810820128303*^9, 3.95981086766051*^9}, {
   3.959811513771495*^9, 3.959811514575712*^9}, {3.959811563867221*^9, 
   3.959811605018972*^9}, {3.959811646571168*^9, 3.9598116466431293`*^9}, {
   3.959811683059569*^9, 3.9598117029717197`*^9}, {3.959811747655061*^9, 
   3.9598118224208183`*^9}, 3.959811876630066*^9, 3.95981209641258*^9, {
   3.9598121787079906`*^9, 3.9598121917499647`*^9}, 3.959812350986835*^9, {
   3.959812428839019*^9, 3.959812442038455*^9}, 3.959812560931497*^9, {
   3.959812612310029*^9, 3.959812612645423*^9}, {3.95981285293437*^9, 
   3.959812872414195*^9}, {3.959812926219624*^9, 
   3.959812932680662*^9}},ExpressionUUID->"f56c3587-e218-4d67-a0ad-\
c721c7b1ecab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vec2ten", "[", 
    RowBox[{"vec_", ",", " ", "fact_"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vec", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"vec", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "/", "fact"}], ",", 
       RowBox[{
        RowBox[{"vec", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "/", "fact"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"vec", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "/", "fact"}], ",", 
       RowBox[{"vec", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"vec", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "/", "fact"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"vec", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "/", "fact"}], ",", 
       RowBox[{
        RowBox[{"vec", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "/", "fact"}], ",", 
       RowBox[{"vec", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ten2vec", "[", 
    RowBox[{"mat_", ",", "fact_"}], "]"}], " ", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mat", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"mat", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"mat", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"fact", " ", 
      RowBox[{"mat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
     RowBox[{"fact", " ", 
      RowBox[{"mat", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", 
     RowBox[{"fact", " ", 
      RowBox[{"mat", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "tangentTransform\[LetterSpace]dSdF\[LetterSpace]to\[LetterSpace]dSdC", 
    "[", 
    RowBox[{"dSdF_", ",", "F_"}], "]"}], " ", ":=", " ", 
   RowBox[{"(", "\n", "\t", 
    RowBox[{
     RowBox[{"F\[LetterSpace]inv", " ", "\[DoubleRightTee]", " ", 
      RowBox[{"SMSInverse", "[", "F", "]"}]}], ";", "\n", "    ", 
     RowBox[{"dSdC", " ", "\[DoubleRightTee]", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"dSdF", "[", 
             RowBox[{"[", 
              RowBox[{"I", ",", "J", ",", "k", ",", "L"}], "]"}], "]"}], " ", 
            "*", " ", 
            RowBox[{"F\[LetterSpace]inv", "[", 
             RowBox[{"[", 
              RowBox[{"K", ",", "k"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "3"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"I", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"J", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"K", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"L", ",", "3"}], "}"}]}], "]"}]}]}], ";", "\n", "    ", 
     RowBox[{"(*", " ", 
      RowBox[{"Enforce", " ", "minor", " ", "symmetries"}], " ", "*)"}], " ", 
     "\n", "    ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"@", "note"}], " ", "The", " ", "resulting", " ", "fourth", 
        " ", "order", " ", "tensor", " ", "has", " ", "no", " ", 
        RowBox[{"perfect", "/", "numerical"}], " ", "major", " ", 
        "symmetry"}], ",", " ", 
       RowBox[{
       "enforcing", " ", "this", " ", "major", " ", "symmetry", " ", "would", 
        " ", "deteriorate", " ", "the", " ", "convergence"}]}], " ", "*)"}], 
     "\n", "    ", 
     RowBox[{"Return", "[", " ", 
      RowBox[{"transform6to4D", "[", 
       RowBox[{"transform4Dto6", "[", "dSdC", "]"}], "]"}], " ", "]"}], ";"}],
     "\n", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"transform6to4D", "[", "A_", "]"}], " ", ":=", " ", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"A4", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\n", 
     RowBox[{"(*", 
      RowBox[{"first", " ", "row"}], "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "1"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "1", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "2"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "1", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "3"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "1", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "4"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "1", ",", "1", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "5"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "1", ",", "2", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "6"}], " ", "]"}], "]"}]}], " ", ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"second", " ", "row"}], "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "2", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "1"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "2", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "2"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "2", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "3"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "2", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "4"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "2", ",", "1", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "5"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "2", ",", "2", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "6"}], " ", "]"}], "]"}]}], " ", ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"third", " ", "row"}], "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"3", ",", "3", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"3", ",", "1"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"3", ",", "3", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"3", ",", "2"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"3", ",", "3", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"3", ",", "3"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"3", ",", "3", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"3", ",", "4"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"3", ",", "3", ",", "1", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"3", ",", "5"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"3", ",", "3", ",", "2", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"3", ",", "6"}], " ", "]"}], "]"}]}], " ", ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"fourth", " ", "row"}], "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "2", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"4", ",", "1"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "2", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"4", ",", "2"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "2", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"4", ",", "3"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "2", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"4", ",", "4"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "2", ",", "1", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"4", ",", "5"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "2", ",", "2", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"4", ",", "6"}], " ", "]"}], "]"}]}], " ", ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"fifth", " ", "row"}], "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "3", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"5", ",", "1"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "3", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"5", ",", "2"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "3", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"5", ",", "3"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "3", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"5", ",", "4"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "3", ",", "1", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"5", ",", "5"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"1", ",", "3", ",", "2", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"5", ",", "6"}], " ", "]"}], "]"}]}], " ", ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"six", " ", "row"}], "*)"}], "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "3", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"6", ",", "1"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "3", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"6", ",", "2"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "3", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"6", ",", "3"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "3", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"6", ",", "4"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "3", ",", "1", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"6", ",", "5"}], " ", "]"}], "]"}]}], " ", ";", "\n", "\t", 
     RowBox[{
      RowBox[{"A4", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"2", ",", "3", ",", "2", ",", "3"}], " ", "]"}], "]"}], " ", 
      "=", 
      RowBox[{"A", " ", "[", 
       RowBox[{"[", " ", 
        RowBox[{"6", ",", "6"}], " ", "]"}], "]"}]}], " ", ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"Exploit", " ", "minor", " ", "symmetries"}], "*)"}], "\n", 
     "\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"{", "\n", "\t\t\t", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"{", "\n", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"A4", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"b", ",", "a", ",", "c", ",", "d"}], "]"}], "]"}],
                    "   ", "=", 
                   RowBox[{"A4", " ", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
                    "]"}]}], " ", ";", "\n", "\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"A4", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"a", ",", "b", ",", "d", ",", "c"}], "]"}], "]"}],
                    "   ", "=", 
                   RowBox[{"A4", " ", "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
                    "]"}]}], " ", ";"}], "\n", "\t\t\t\t\t", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "3"}], "}"}]}], "]"}], "\n", "\t\t\t\t", 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"c", ",", "3"}], "}"}]}], "]"}], "\n", "\t\t\t", "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "3"}], "}"}]}], "]"}], "\n", "\t\t", "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"a", ",", "3"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Return", " ", "results", " ", "A4"}], " ", "*)"}], " ", "\n", 
     "A4"}], "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"transform4Dto6", "[", "A_", "]"}], " ", ":=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", "\t\t\t\t\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "1", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "1", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "1", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "1", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "1", ",", "1", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "1", ",", "2", ",", "3"}], " ", "]"}], "]"}]}], 
      "}"}], ",", "\n", "\t\t\t\t\t       ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "2", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "2", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "2", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "2", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "2", ",", "1", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "2", ",", "2", ",", "3"}], " ", "]"}], "]"}]}], 
      "}"}], ",", "\n", "\t\t\t\t\t       ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "3", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "3", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "3", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "3", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "3", ",", "1", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "3", ",", "2", ",", "3"}], " ", "]"}], "]"}]}], 
      "}"}], ",", "\n", "\t\t\t\t\t       ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "2", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "2", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "2", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "2", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "2", ",", "1", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "2", ",", "2", ",", "3"}], " ", "]"}], "]"}]}], 
      "}"}], ",", "\n", "\t\t\t\t\t       ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "3", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "3", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "3", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "3", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "3", ",", "1", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "3", ",", "2", ",", "3"}], " ", "]"}], "]"}]}], 
      "}"}], ",", "\n", "\t\t\t\t\t       ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "3", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "3", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "3", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "3", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "3", ",", "1", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "3", ",", "2", ",", "3"}], " ", "]"}], "]"}]}], 
      "}"}]}], "\[IndentingNewLine]", "\t\t\t\t    ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"transform4DtoMat", "[", "A_", "]"}], " ", ":=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", "\t\t\t\t\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "1", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "1", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "1", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "1", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "1", ",", "2", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "1", ",", "3", ",", "1"}], " ", "]"}], "]"}]}], 
      "}"}], ",", "\n", "\t\t\t\t\t       ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "2", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "2", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "2", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "2", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "2", ",", "2", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "2", ",", "3", ",", "1"}], " ", "]"}], "]"}]}], 
      "}"}], ",", "\n", "\t\t\t\t\t       ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "3", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "3", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "3", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "3", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "3", ",", "2", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "3", ",", "3", ",", "1"}], " ", "]"}], "]"}]}], 
      "}"}], ",", "\n", "\t\t\t\t\t       ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "2", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "2", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "2", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "2", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "2", ",", "2", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"1", ",", "2", ",", "3", ",", "1"}], " ", "]"}], "]"}]}], 
      "}"}], ",", "\n", "\t\t\t\t\t       ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "3", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "3", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "3", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "3", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "3", ",", "2", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"2", ",", "3", ",", "3", ",", "1"}], " ", "]"}], "]"}]}], 
      "}"}], ",", "\n", "\t\t\t\t\t       ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "1", ",", "1", ",", "1"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "1", ",", "2", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "1", ",", "3", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "1", ",", "1", ",", "2"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "1", ",", "2", ",", "3"}], " ", "]"}], "]"}], " ", 
       ",", 
       RowBox[{"A", " ", "[", 
        RowBox[{"[", " ", 
         RowBox[{"3", ",", "1", ",", "3", ",", "1"}], " ", "]"}], "]"}]}], 
      "}"}]}], "\[IndentingNewLine]", "\t\t\t\t    ", "}"}]}], 
  ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413737500931*^9}, {3.9594144559111023`*^9, 
   3.9594145771414433`*^9}, {3.959414611113225*^9, 3.959414705729742*^9}, {
   3.9594147558803062`*^9, 3.959414970422175*^9}, {3.959415014276359*^9, 
   3.9594151211315536`*^9}, {3.959415154042604*^9, 3.959415217163155*^9}, {
   3.959415251002194*^9, 3.959415510058682*^9}, {3.9594155749785633`*^9, 
   3.9594156917892923`*^9}, {3.959415734369328*^9, 3.9594158717082653`*^9}, {
   3.959417094189485*^9, 3.9594172123084583`*^9}, {3.9598106957923813`*^9, 
   3.9598107354250298`*^9}, {3.959810820128303*^9, 3.95981086766051*^9}, {
   3.959811513771495*^9, 3.959811514575712*^9}, {3.959811563867221*^9, 
   3.959811605018972*^9}, {3.959811646571168*^9, 3.9598116466431293`*^9}, {
   3.959811683059569*^9, 3.9598117029717197`*^9}, {3.959811747655061*^9, 
   3.9598118224208183`*^9}, 3.959811876630066*^9, 3.95981209641258*^9, {
   3.9598121787079906`*^9, 3.9598121917499647`*^9}, 3.959812350986835*^9, {
   3.959812428839019*^9, 3.959812442038455*^9}, 3.959812560931497*^9, {
   3.959812612310029*^9, 3.959812612645423*^9}, {3.95981285293437*^9, 
   3.9598129262197657`*^9}, {3.95981630165933*^9, 3.959816301860524*^9}, {
   3.959816547356552*^9, 3.959816566175207*^9}, {3.959940027275769*^9, 
   3.959940177105832*^9}},
 CellLabel->
  "In[432]:=",ExpressionUUID->"be90e029-048d-4071-b674-a84c868cd0c3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Material parameters ", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413737500931*^9}, {3.9594144559111023`*^9, 
   3.9594145771414433`*^9}, {3.959414611113225*^9, 3.959414705729742*^9}, {
   3.9594147558803062`*^9, 3.959414970422175*^9}, {3.959415014276359*^9, 
   3.9594151211315536`*^9}, {3.959415154042604*^9, 3.959415217163155*^9}, {
   3.959415251002194*^9, 3.959415510058682*^9}, {3.9594155749785633`*^9, 
   3.9594156917892923`*^9}, {3.959415734369328*^9, 3.9594158717082653`*^9}, {
   3.959417094189485*^9, 3.9594172123084583`*^9}, {3.9598106957923813`*^9, 
   3.9598107354250298`*^9}, {3.959810820128303*^9, 3.95981086766051*^9}, {
   3.959811513771495*^9, 3.959811514575712*^9}, {3.959811563867221*^9, 
   3.959811605018972*^9}, {3.959811646571168*^9, 3.9598116466431293`*^9}, {
   3.959811683059569*^9, 3.9598117029717197`*^9}, {3.959811747655061*^9, 
   3.9598118224208183`*^9}, 3.959811876630066*^9, 3.95981209641258*^9, {
   3.9598121787079906`*^9, 3.9598121917499647`*^9}, 3.959812350986835*^9, {
   3.959812428839019*^9, 3.959812442038455*^9}, 3.959812560931497*^9, {
   3.959812612310029*^9, 3.959812646879098*^9}, {3.959815024833459*^9, 
   3.959815052897393*^9}},ExpressionUUID->"0454cc4c-66d4-447d-b785-\
fbbe70c33849"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "retrieve\[LetterSpace]material\[LetterSpace]parameters", "[", "cm_", 
     "]"}], ":=", 
    RowBox[{"(", " ", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Elasticity", " ", "*)"}], " ", "\[IndentingNewLine]",
      "    ", 
     RowBox[{
      RowBox[{"bulkMod\[LetterSpace]kappa", " ", "\[DoubleRightTee]", 
       RowBox[{"cmGet", "[", 
        RowBox[{"\"\<bulkMod\>\"", ",", "cm"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "    ", 
      RowBox[{"shearMod\[LetterSpace]mu", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"cmGet", "[", 
        RowBox[{"\"\<shearMod\>\"", ",", "cm"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "  ", 
      RowBox[{"(*", " ", "Plasticity", " ", "*)"}], " ", 
      "\[IndentingNewLine]", "    ", 
      RowBox[{"yieldStress", " ", "\[DoubleRightTee]", 
       RowBox[{"cmGet", "[", 
        RowBox[{"\"\<yieldStress\>\"", ",", "cm"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "    ", 
      RowBox[{"hardMod", " ", "\[DoubleRightTee]", 
       RowBox[{"cmGet", "[", 
        RowBox[{"\"\<hardMod\>\"", ",", "cm"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "    ", 
      RowBox[{"yieldStressIncr", " ", "\[DoubleRightTee]", 
       RowBox[{"cmGet", "[", 
        RowBox[{"\"\<yieldStressIncr\>\"", ",", "cm"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "    ", 
      RowBox[{"saturation", " ", "\[DoubleRightTee]", 
       RowBox[{"cmGet", "[", 
        RowBox[{"\"\<saturation\>\"", ",", "cm"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "    ", 
      RowBox[{"expo", " ", "\[DoubleRightTee]", 
       RowBox[{"cmGet", "[", 
        RowBox[{"\"\<expo\>\"", ",", "cm"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "    ", 
      RowBox[{"PowExpo", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"SMSIf", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"SMSAbs", "[", 
           RowBox[{"cmGet", "[", 
            RowBox[{"\"\<PowExpo\>\"", ",", "cm"}], "]"}], "]"}], "<", 
          "1*^-6"}], ",", "1", ",", 
         RowBox[{"cmGet", "[", 
          RowBox[{"\"\<PowExpo\>\"", ",", "cm"}], "]"}]}], " ", "]"}]}], ";", 
      "\[IndentingNewLine]", "  ", 
      RowBox[{"(*", " ", "Damage", " ", "*)"}], " ", "\[IndentingNewLine]", 
      "    ", 
      RowBox[{"DP1", " ", "\[DoubleRightTee]", 
       RowBox[{"cmGet", "[", 
        RowBox[{"\"\<DP1\>\"", ",", "cm"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "    ", 
      RowBox[{"DP2", " ", "\[DoubleRightTee]", 
       RowBox[{"cmGet", "[", 
        RowBox[{"\"\<DP2\>\"", ",", "cm"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "    ", 
      RowBox[{"DExpo", " ", "\[DoubleRightTee]", 
       RowBox[{"cmGet", "[", 
        RowBox[{"\"\<DExpo\>\"", ",", "cm"}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "A", " ", "list", " ", "associating", " ", "the", " ", "name", " ", "of", 
    " ", "a", " ", "parameter", " ", "such", " ", "as", " ", 
    "\"\<bulkMod\>\"", " ", "to", " ", "its", " ", "index", " ", "in", " ", 
    "the", " ", "list", " ", "of", " ", "material", " ", "parameters", " ", 
    "\"\<cm\>\""}], " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cm\[LetterSpace]associations", " ", "=", "\n", "    ", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Coding", "/", "debugging"}], "/", "settings"}], " ", "*)"}], 
    " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<debugging\>\"", "\[Rule]", "5"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Elasticity", " ", "*)"}], " ", "\[IndentingNewLine]",
      " ", 
     RowBox[{"\"\<bulkMod\>\"", " ", "\[Rule]", " ", "9"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"\"\<shearMod\>\"", " ", "\[Rule]", " ", "10"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Plasticity", " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{"\"\<yieldStress\>\"", "\[Rule]", "18"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<hardMod\>\"", "\[Rule]", "19"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<yieldStressIncr\>\"", "\[Rule]", "20"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<saturation\>\"", "\[Rule]", "21"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<expo\>\"", "\[Rule]", "22"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<PowExpo\>\"", "\[Rule]", "23"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Damage", " ", "coupling"}], " ", "*)"}], " ", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<DVOL\>\"", "\[Rule]", "25"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<DDEV\>\"", "\[Rule]", "26"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<DPLA\>\"", "\[Rule]", "27"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Damage", " ", "parameters"}], " ", "*)"}], " ", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<DP1\>\"", "\[Rule]", "28"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<DP2\>\"", "\[Rule]", "29"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<DExpo\>\"", "\[Rule]", "30"}]}], "\n", "    ", "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cmGet", "[", 
    RowBox[{"namePRM_", ",", "cm_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
   RowBox[{"(", "\n", "\t", 
    RowBox[{
     RowBox[{"index", " ", "=", " ", 
      RowBox[{"cm\[LetterSpace]associations", "[", "namePRM", "]"}]}], ";", 
     "\n", "\t", 
     RowBox[{"Return", "[", " ", 
      RowBox[{"cm", "[", 
       RowBox[{"[", " ", "index", " ", "]"}], "]"}], "]"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413737500931*^9}, {3.9594144559111023`*^9, 
   3.9594145771414433`*^9}, {3.959414611113225*^9, 3.959414705729742*^9}, {
   3.9594147558803062`*^9, 3.959414970422175*^9}, {3.959415014276359*^9, 
   3.9594151211315536`*^9}, {3.959415154042604*^9, 3.959415217163155*^9}, {
   3.959415251002194*^9, 3.959415510058682*^9}, {3.9594155749785633`*^9, 
   3.9594156917892923`*^9}, {3.959415734369328*^9, 3.9594158717082653`*^9}, {
   3.959417094189485*^9, 3.9594172123084583`*^9}, {3.9598106957923813`*^9, 
   3.9598107354250298`*^9}, {3.959810820128303*^9, 3.95981086766051*^9}, {
   3.959811513771495*^9, 3.959811514575712*^9}, {3.959811563867221*^9, 
   3.959811605018972*^9}, {3.959811646571168*^9, 3.9598116466431293`*^9}, {
   3.959811683059569*^9, 3.9598117029717197`*^9}, {3.959811747655061*^9, 
   3.9598118224208183`*^9}, 3.959811876630066*^9, 3.95981209641258*^9, {
   3.9598121787079906`*^9, 3.9598121917499647`*^9}, 3.959812350986835*^9, {
   3.959812428839019*^9, 3.959812442038455*^9}, 3.959812560931497*^9, {
   3.959812612310029*^9, 3.959812640234902*^9}, {3.9598129841524973`*^9, 
   3.9598130039607553`*^9}, {3.959813086992066*^9, 3.959813302098082*^9}, {
   3.959813364796803*^9, 3.9598133705148697`*^9}, {3.9598137405806313`*^9, 
   3.959813818617402*^9}, {3.959813967449436*^9, 3.959813994224573*^9}, {
   3.959814820678521*^9, 3.959814843903832*^9}, {3.959814906215438*^9, 
   3.9598149300082397`*^9}, 3.9598149989810133`*^9, 3.959815057482724*^9, {
   3.9598244152444983`*^9, 3.9598244159155407`*^9}, {3.959833689401537*^9, 
   3.95983369136404*^9}, {3.959833731698497*^9, 3.959833764228034*^9}, {
   3.960334752454055*^9, 3.960334837860259*^9}, {3.960334942532399*^9, 
   3.960334952498374*^9}},
 CellLabel->
  "In[438]:=",ExpressionUUID->"5cfe49fc-c21e-4553-8c92-5059d1a5995c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["History variables", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413737500931*^9}, {3.9594144559111023`*^9, 
   3.9594145771414433`*^9}, {3.959414611113225*^9, 3.959414705729742*^9}, {
   3.9594147558803062`*^9, 3.959414970422175*^9}, {3.959415014276359*^9, 
   3.9594151211315536`*^9}, {3.959415154042604*^9, 3.959415217163155*^9}, {
   3.959415251002194*^9, 3.959415510058682*^9}, {3.9594155749785633`*^9, 
   3.9594156917892923`*^9}, {3.959415734369328*^9, 3.9594158717082653`*^9}, {
   3.959417094189485*^9, 3.9594172123084583`*^9}, {3.9598106957923813`*^9, 
   3.9598107354250298`*^9}, {3.959810820128303*^9, 3.95981086766051*^9}, {
   3.959811513771495*^9, 3.959811514575712*^9}, {3.959811563867221*^9, 
   3.959811605018972*^9}, {3.959811646571168*^9, 3.9598116466431293`*^9}, {
   3.959811683059569*^9, 3.9598117029717197`*^9}, {3.959811747655061*^9, 
   3.9598118224208183`*^9}, 3.959811876630066*^9, 3.95981209641258*^9, {
   3.9598121787079906`*^9, 3.9598121917499647`*^9}, 3.959812350986835*^9, {
   3.959812428839019*^9, 3.959812442038455*^9}, 3.959812560931497*^9, {
   3.959812612310029*^9, 3.959812640234902*^9}, {3.9598129841524973`*^9, 
   3.9598130039607553`*^9}, {3.959813086992066*^9, 3.959813302098082*^9}, {
   3.959813364796803*^9, 3.9598133705148697`*^9}, {3.9598137405806313`*^9, 
   3.959813818617402*^9}, {3.959813967449436*^9, 3.959813994224573*^9}, {
   3.959814820678521*^9, 3.959814843903832*^9}, {3.959814906215438*^9, 
   3.9598149300082397`*^9}, 3.9598149989810133`*^9, {3.959815057482724*^9, 
   3.9598150727555*^9}},ExpressionUUID->"b453eeab-ffc4-4732-b094-\
4077c61924aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "retrieve\[LetterSpace]history\[LetterSpace]variables", "[", "hsvn_", 
     "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{"iRCGpN", " ", "\[DoubleRightTee]", " ", 
       RowBox[{
       "RCG\[LetterSpace]plastic\[LetterSpace]inverse\[LetterSpace]n", "[", 
        "hsvn", "]"}]}], ";", "\[IndentingNewLine]", "  ", 
      RowBox[{"alpha\[LetterSpace]n", " ", "\[DoubleRightTee]", 
       RowBox[{"hsvGet", "[", 
        RowBox[{"\"\<alpha\>\"", ",", "hsvn"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "  ", 
      RowBox[{
      "H\[LetterSpace]p\[LetterSpace]acc\[LetterSpace]n", " ", 
       "\[DoubleRightTee]", 
       RowBox[{"hsvGet", "[", 
        RowBox[{"\"\<H_p_acc\>\"", ",", "hsvn"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "  ", 
      RowBox[{"d\[LetterSpace]n", " ", "\[DoubleRightTee]", 
       RowBox[{"hsvGet", "[", 
        RowBox[{"\"\<dmg\>\"", ",", "hsvn"}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Associating", " ", "the", " ", "name", " ", "of", " ", "a", " ", 
    "history", " ", "variable", " ", "such", " ", "as", " ", "\"\<alpha\>\"", 
    " ", "to", " ", "its", " ", "index", " ", "in", " ", "the", " ", "list", 
    " ", "of", " ", "history", " ", "variables", " ", "\"\<hsv\>\""}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhsv\[LetterSpace]per\[LetterSpace]QP", " ", "=", "9"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hsvIndex", "[", "nameHSV_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Index", " ", "=", " ", 
      RowBox[{"Switch", "[", "\n", "\t\t\t\t\t", 
       RowBox[{
       "nameHSV", ",", "\n", "\t\t\t\t\t", "\"\<alpha\>\"", ",", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"scalar", " ", "hardening", " ", "variable", " ", 
          RowBox[{"(", 
           RowBox[{"1", " ", "component"}], ")"}]}], " ", "*)"}], " ", "\n", 
        "\t\t\t\t\t", "\"\<plasticStrain\>\"", ",", " ", 
        RowBox[{"{", 
         RowBox[{"2", ",", "7"}], "}"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "symmetric", " ", "inverse", " ", "plastic", " ", "right", " ", 
          "stretch", " ", 
          RowBox[{"(", 
           RowBox[{"6", " ", "components"}], ")"}]}], " ", "*)"}], " ", "\n", 
        "\t\t\t\t\t", "\"\<H_p_acc\>\"", ",", " ", 
        RowBox[{"{", 
         RowBox[{"8", ",", "8"}], "}"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"undamaged", " ", "hardening", " ", "variable", " ", 
          RowBox[{"(", 
           RowBox[{"1", " ", "component"}], ")"}]}], " ", "*)"}], " ", "\n", 
        "\t\t\t\t\t", "\"\<dmg\>\"", ",", " ", 
        RowBox[{"{", 
         RowBox[{"9", ",", "9"}], "}"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"local", " ", "damage", " ", "variable", " ", 
          RowBox[{"(", 
           RowBox[{"1", " ", "component"}], ")"}]}], " ", "*)"}], " ", "\n", 
        "\t\t\t\t\t", "_", ",", " ", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"hsvIndex", "::", "len"}], " ", "=", " ", 
          "\"\<hsvIndex<< parameter `1` is not defined.\>\""}], ";", "\n", 
         "\t\t\t\t\t", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"hsvIndex", "::", "len"}], ",", " ", "nameHSV"}], "]"}], 
         ";", " ", 
         RowBox[{"Abort", "[", "]"}], ";"}]}], "\n", "\t\t\t\t   ", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", " ", "Index", " ", "]"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hsvGet", "[", 
    RowBox[{"nameHSV_", ",", "hsv_"}], "]"}], " ", ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(", "\n", "          ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"indexStart", ",", "indexEnd"}], "}"}], " ", "=", " ", 
      RowBox[{"hsvIndex", "[", "nameHSV", "]"}]}], ";", "\n", "          ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"indexStart", "==", "indexEnd"}], ",", " ", "\n", 
       "                 ", 
       RowBox[{"Return", "[", " ", 
        RowBox[{"hsv", "[", 
         RowBox[{"[", "indexStart", "]"}], "]"}], " ", "]"}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"for", " ", "a", " ", "scalar"}], ",", " ", 
         RowBox[{"return", " ", "a", " ", "scalar", " ", "value"}]}], " ", 
        "*)"}], "\n", "                 ", 
       RowBox[{"Return", "[", " ", 
        RowBox[{"hsv", "[", 
         RowBox[{"[", 
          RowBox[{"indexStart", ";;", "indexEnd"}], "]"}], "]"}], " ", 
        "]"}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"for", " ", "a", " ", "vector"}], ",", " ", 
        RowBox[{"return", " ", "a", " ", "range"}]}], " ", "*)"}], "\n", 
      "              ", "]"}], ";"}], "\n", "      ", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SMSExport\[LetterSpace]hsv", "[", 
   RowBox[{"value_", ",", "nameHSV_", ",", "hsv_"}], "]"}], " ", ":=", " ", 
  "\n", "      ", 
  RowBox[{"(", "\n", "          ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"indexStart", ",", "indexEnd"}], "}"}], " ", "=", " ", 
     RowBox[{"hsvIndex", "[", "nameHSV", "]"}]}], ";", "\n", "          ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"indexStart", "==", "indexEnd"}], ",", " ", "\n", 
      "                 ", 
      RowBox[{"SMSExport", "[", 
       RowBox[{"value", ",", " ", 
        RowBox[{"hsv", "[", "indexStart", "]"}]}], "]"}], ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"for", " ", "a", " ", "scalar"}], ",", " ", 
        RowBox[{"export", " ", "a", " ", "scalar", " ", "value"}]}], " ", 
       "*)"}], "\n", "                 ", 
      RowBox[{"SMSExport", "[", 
       RowBox[{"value", ",", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"hsv", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "indexStart", ",", "indexEnd"}], "}"}]}], 
         "]"}]}], " ", "]"}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"for", " ", "a", " ", "vector"}], ",", " ", 
       RowBox[{"export", " ", "a", " ", "table"}]}], " ", "*)"}], "\n", 
     "              ", "]"}], ";"}], "\n", "      ", ")"}]}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413737500931*^9}, {3.9594144559111023`*^9, 
   3.9594145771414433`*^9}, {3.959414611113225*^9, 3.959414705729742*^9}, {
   3.9594147558803062`*^9, 3.959414970422175*^9}, {3.959415014276359*^9, 
   3.9594151211315536`*^9}, {3.959415154042604*^9, 3.959415217163155*^9}, {
   3.959415251002194*^9, 3.959415510058682*^9}, {3.9594155749785633`*^9, 
   3.9594156917892923`*^9}, {3.959415734369328*^9, 3.9594158717082653`*^9}, {
   3.959417094189485*^9, 3.9594172123084583`*^9}, {3.9598106957923813`*^9, 
   3.9598107354250298`*^9}, {3.959810820128303*^9, 3.95981086766051*^9}, {
   3.959811513771495*^9, 3.959811514575712*^9}, {3.959811563867221*^9, 
   3.959811605018972*^9}, {3.959811646571168*^9, 3.9598116466431293`*^9}, {
   3.959811683059569*^9, 3.9598117029717197`*^9}, {3.959811747655061*^9, 
   3.9598118224208183`*^9}, 3.959811876630066*^9, 3.95981209641258*^9, {
   3.9598121787079906`*^9, 3.9598121917499647`*^9}, 3.959812350986835*^9, {
   3.959812428839019*^9, 3.959812442038455*^9}, 3.959812560931497*^9, {
   3.959812612310029*^9, 3.959812640234902*^9}, {3.9598129841524973`*^9, 
   3.9598130039607553`*^9}, {3.959813086992066*^9, 3.959813302098082*^9}, {
   3.959813364796803*^9, 3.9598133705148697`*^9}, {3.9598137405806313`*^9, 
   3.959813818617402*^9}, {3.959813967449436*^9, 3.959813994224573*^9}, {
   3.959814820678521*^9, 3.959814843903832*^9}, {3.959814906215438*^9, 
   3.9598149300082397`*^9}, 3.9598149989810133`*^9, {3.959815057482724*^9, 
   3.959815098203492*^9}},
 CellLabel->
  "In[441]:=",ExpressionUUID->"20099fcd-bee4-4da4-a920-366ad25b3ba4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Auxiliary functions", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413737500931*^9}, {3.9594144559111023`*^9, 
   3.9594145771414433`*^9}, {3.959414611113225*^9, 3.959414705729742*^9}, {
   3.9594147558803062`*^9, 3.959414970422175*^9}, {3.959415014276359*^9, 
   3.9594151211315536`*^9}, {3.959415154042604*^9, 3.959415217163155*^9}, {
   3.959415251002194*^9, 3.959415510058682*^9}, {3.9594155749785633`*^9, 
   3.9594156917892923`*^9}, {3.959415734369328*^9, 3.9594158717082653`*^9}, {
   3.959417094189485*^9, 3.9594172123084583`*^9}, {3.9598106957923813`*^9, 
   3.9598107354250298`*^9}, {3.959810820128303*^9, 3.95981086766051*^9}, {
   3.959811513771495*^9, 3.959811514575712*^9}, {3.959811563867221*^9, 
   3.959811605018972*^9}, {3.959811646571168*^9, 3.9598116466431293`*^9}, {
   3.959811683059569*^9, 3.9598117029717197`*^9}, {3.959811747655061*^9, 
   3.9598118224208183`*^9}, 3.959811876630066*^9, 3.95981209641258*^9, {
   3.9598121787079906`*^9, 3.9598121917499647`*^9}, 3.959812350986835*^9, {
   3.959812428839019*^9, 3.959812442038455*^9}, 3.959812560931497*^9, {
   3.959812612310029*^9, 3.959812640234902*^9}, {3.9598129841524973`*^9, 
   3.9598130039607553`*^9}, {3.959813086992066*^9, 3.959813302098082*^9}, {
   3.959813364796803*^9, 3.9598133705148697`*^9}, {3.9598137405806313`*^9, 
   3.959813818617402*^9}, {3.959813967449436*^9, 3.959813994224573*^9}, {
   3.959814820678521*^9, 3.959814843903832*^9}, {3.959814906215438*^9, 
   3.9598149300082397`*^9}, {3.9598149989810133`*^9, 
   3.9598150132510567`*^9}},ExpressionUUID->"727bb64a-60ce-411e-9846-\
f00838950c1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getEIG", "[", "tensor_", "]"}], " ", ":=", " ", 
    RowBox[{"(", "\n", "  ", 
     RowBox[{
      RowBox[{"subrEIG", " ", "=", " ", 
       RowBox[{"SMSCall", "[", 
        RowBox[{
        "\"\<eig_EW_EB_d_AG\>\"", ",", " ", "tensor", ",", "  ", "2", ",", 
         " ", 
         RowBox[{"Real", "[", 
          RowBox[{
           RowBox[{"EW$$", "[", "3", "]"}], ",", " ", 
           RowBox[{"EB$$", "[", 
            RowBox[{"3", ",", " ", "3", ",", " ", "3"}], "]"}], ",", " ", 
           RowBox[{"dEWdtensor$$", "[", 
            RowBox[{"3", ",", " ", "3", ",", " ", "3"}], "]"}], ",", " ", 
           RowBox[{"dEBdtensor$$", "[", 
            RowBox[{
            "3", ",", " ", "3", ",", " ", "3", ",", " ", "3", ",", " ", "3"}],
             "]"}]}], "]"}], ",", " ", 
         RowBox[{"\"\<System\>\"", " ", "->", " ", "False"}]}], "]"}]}], ";", 
      "\n", "  ", 
      RowBox[{"dEWdtensor", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"SMSReal", "[", 
        RowBox[{
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"dEWdtensor$$", "[", 
            RowBox[{"iEW", ",", " ", "i", ",", " ", "j"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"iEW", ",", " ", "3"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "3"}], "}"}], ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"j", ",", " ", "3"}], "}"}]}], " ", "]"}], ",", " ", 
         RowBox[{"\"\<Subordinate\>\"", " ", "->", " ", "subrEIG"}]}], 
        "]"}]}], ";", "\n", "  ", 
      RowBox[{"EW", " ", "\[DoubleRightTee]", "  ", 
       RowBox[{"SMSReal", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"iEW", ",", " ", "3"}], "}"}]}], "]"}], "]"}]}], ";", "\n",
       "  ", 
      RowBox[{"EW\[LetterSpace]sqrt", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"SMSReal", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"iEW", ",", " ", "3"}], "}"}]}], "]"}], "]"}]}], ";", "\n",
       "  ", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"{", "\n", "    ", 
         RowBox[{
          RowBox[{
           RowBox[{"EW", " ", "[", 
            RowBox[{"[", " ", "iEW", "]"}], "]"}], " ", "\[RightTee]", " ", 
           RowBox[{"SMSReal", "[", 
            RowBox[{
             RowBox[{"EW$$", "[", "iEW", "]"}], ",", " ", 
             RowBox[{"\"\<Subordinate\>\"", " ", "->", " ", "subrEIG"}], ",", 
             " ", 
             RowBox[{"\"\<Dependency\>\"", " ", "\[Rule]", " ", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"tensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", " ", "l"}], " ", "]"}], "]"}], ",", " ", 
                    RowBox[{"dEWdtensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"iEW", ",", " ", "k", ",", " ", "l"}], "]"}], 
                    "]"}]}], "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", " ", "3"}], "}"}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"l", ",", " ", "3"}], "}"}]}], "]"}], ",", " ", 
                "1"}], "]"}]}]}], "]"}]}], ";", "\n", "    ", 
          RowBox[{
           RowBox[{"EW\[LetterSpace]sqrt", " ", "[", 
            RowBox[{"[", " ", "iEW", " ", "]"}], "]"}], " ", "\[RightTee]", 
           " ", 
           RowBox[{"SMSSqrt", "[", "  ", 
            RowBox[{"EW", " ", "[", 
             RowBox[{"[", " ", "iEW", " ", "]"}], "]"}], " ", "]"}]}], ";"}], 
         "\n", "    ", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"iEW", ",", " ", "3"}], "}"}]}], "]"}], ";", "\n", "   ", 
      RowBox[{"dEBdtensor", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"SMSReal", "[", 
        RowBox[{
         RowBox[{"Table", "[", "  ", 
          RowBox[{
           RowBox[{"dEBdtensor$$", "[", 
            RowBox[{
            "iEW", ",", " ", "i", ",", " ", "j", ",", " ", "k", ",", " ", 
             "l"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"iEW", ",", " ", "3"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "3"}], "}"}], ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"j", ",", " ", "3"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"k", ",", "3"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"l", ",", " ", "3"}], "}"}]}], " ", "]"}], ",", " ", 
         RowBox[{"\"\<Subordinate\>\"", " ", "->", " ", "subrEIG"}]}], 
        "]"}]}], ";", "\n", "   ", 
      RowBox[{"EB", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"SMSReal", "[", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"iEW", ",", " ", "3"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "3"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "3"}], "}"}]}], "]"}], "]"}]}], ";", "\n", 
      "  ", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"{", "\n", "    ", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"{", "\n", "      ", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"{", "\n", "        ", 
               RowBox[{
                RowBox[{"EB", " ", "[", 
                 RowBox[{"[", " ", 
                  RowBox[{"iEW", ",", " ", "i", ",", " ", "j"}], "]"}], "]"}],
                 " ", "\[RightTee]", " ", 
                RowBox[{"SMSReal", "[", 
                 RowBox[{
                  RowBox[{"EB$$", "[", 
                   RowBox[{"iEW", ",", " ", "i", ",", " ", "j"}], "]"}], ",", 
                  " ", 
                  RowBox[{"\"\<Subordinate\>\"", " ", "->", " ", "subrEIG"}], 
                  ",", " ", 
                  RowBox[{"\"\<Dependency\>\"", " ", "->", "   ", 
                   RowBox[{"Flatten", "[", "  ", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tensor", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", " ", "l"}], " ", "]"}], "]"}], ",", " ", 
                    RowBox[{"dEBdtensor", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    "iEW", ",", " ", "i", ",", " ", "j", ",", " ", "k", ",", 
                    " ", "l"}], "]"}], "]"}]}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", " ", "3"}], "}"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", " ", "3"}], "}"}]}], "]"}], ",", " ", 
                    "1"}], "]"}]}]}], "]"}]}], "\n", "        ", "}"}], ",", 
              " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", "3"}], "}"}]}], "]"}], "\n", "      ", 
            "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", "    ", "}"}],
         ",", " ", 
        RowBox[{"{", 
         RowBox[{"iEW", ",", " ", "3"}], "}"}]}], "]"}], ";", "\n", "    ", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"EW\[LetterSpace]sqrt", ",", "EB"}], "}"}], "]"}], ";"}], 
     "\n", " ", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SMSPowerAG", "[", 
    RowBox[{"x_", ",", "expo_"}], "]"}], " ", ":=", " ", "\n", 
   RowBox[{"(", "\n", "\t", 
    RowBox[{
     RowBox[{"x0", " ", "=", " ", "1*^-4"}], ";", "\n", "\t", 
     RowBox[{"SMSAddFormat", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{"SMSNearestInteger", "[", "integerIn_", "]"}], ":>", "\n", 
       "\t\t\t", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "SMSLanguage", ",", "\n", "\t\t\t\t", "\"\<Fortran\>\"", ",", 
         RowBox[{"\"\<nint\>\"", "[", "integerIn", "]"}], ",", "\n", 
         "\t\t\t\t", "\"\<Matlab\>\"", ",", 
         RowBox[{"\"\<round\>\"", "[", "integerIn", "]"}], ",", "\n", 
         "\t\t\t\t", "\"\<C++\>\"", ",", 
         RowBox[{"\"\<round\>\"", "[", "integerIn", "]"}]}], "\n", "\t\t\t  ",
         "]"}]}], "\n", "\t", "]"}], ";", "\n", "\t", 
     RowBox[{"Return", "[", "\n", "\t\t", 
      RowBox[{"SMSIf", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"SMSNearestInteger", "[", 
             RowBox[{"1.", "*", "expo"}], "]"}], "-", "expo"}], "]"}], ">", 
          "1*^-4"}], " ", "||", " ", 
         RowBox[{"expo", "<", "1"}]}], ",", " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"stabilise", " ", "all", " ", "non"}], "-", 
           RowBox[{
           "integer", " ", "exponents", " ", "and", " ", "exponents"}]}], "<",
           "1"}], "*)"}], " ", "\n", "\t\t\t ", 
        RowBox[{"SMSIf", "[", 
         RowBox[{
          RowBox[{"x", " ", "<", " ", 
           RowBox[{"-", "x0"}]}], ",", "\n", "\t\t\t            ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "Limit", " ", "the", " ", "polynomial", " ", "approximation", 
              " ", "for", " ", "x"}], "<", 
             RowBox[{"-", "x0"}]}], ",", " ", 
            RowBox[{
            "so", " ", "that", " ", "is", " ", "does", " ", "not", " ", 
             "shoot", " ", "to", " ", "infinity", " ", "so", " ", "quickly"}],
             ",", " ", 
            RowBox[{
            "which", " ", "would", " ", "generate", " ", "problems", " ", 
             "with", " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"...", "Power"}], "]"}]}]}], " ", "*)"}], "\n", 
          "\t\t\t            ", 
          RowBox[{
           RowBox[{"1", "/", "15"}], " ", 
           RowBox[{"x0", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "expo"}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"5", " ", "expo", " ", 
              RowBox[{"(", 
               RowBox[{"93", "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "6"}], "+", "expo"}], ")"}], " ", "expo", " ", 
                 RowBox[{"(", 
                  RowBox[{"14", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "6"}], "+", "expo"}], ")"}], " ", "expo"}]}],
                   ")"}]}]}], ")"}], " ", "x"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "expo"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "15"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "4"}], "+", "expo"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "expo"}], ")"}], " ", "expo", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "14"}], "+", 
                   RowBox[{"3", " ", "expo"}]}], ")"}]}]}], ")"}], " ", 
              "x0"}]}], ")"}]}], ",", "\n", "\t\t\t            ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "Use", " ", "5", "th", " ", "order", " ", "polynomial", " ", "to",
              " ", "approximate", " ", "the", " ", "exponential", " ", 
             "function", " ", "between"}], " ", "-", 
            RowBox[{"inf", " ", "and", " ", "x0"}]}], "*)"}], "\n", 
          "\t\t\t            ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "The", " ", "polynomial", " ", "is", " ", "designed", " ", "such",
              " ", "that", " ", 
             RowBox[{"y", "[", "x0", "]"}]}], "=", 
            RowBox[{
             RowBox[{"x0", "^", "expo"}], " ", "and", " ", "that", " ", "the",
              " ", "first", " ", "to", " ", "fifth", " ", "derivatives", " ", 
             "at", " ", "x0", " ", "are", " ", "identical", " ", "to", " ", 
             "the", " ", "derivatives", " ", "of", " ", "the", " ", "exact", 
             " ", "function", " ", 
             RowBox[{"x", "^", "expo"}]}]}], " ", "*)"}], "\n", 
          "\t\t\t            ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"tested", " ", "for", " ", "expo"}], "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.5", ",", "0.99", ",", 
               RowBox[{"-", "2"}]}], "}"}], " ", "[", 
             "\"\<Power - non-singular function.nb\>\"", "]"}]}], "*)"}], 
          "\n", "\t\t\t\t    ", 
          RowBox[{"SMSIf", "[", 
           RowBox[{
            RowBox[{"x", "<", "x0"}], ",", "\n", "\t    \t\t\t\t     ", 
            RowBox[{
             RowBox[{"1", "/", "120"}], " ", 
             RowBox[{"x0", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "5"}], "+", "expo"}], ")"}]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "4"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "expo"}], ")"}], " ", "expo", " ", 
                
                RowBox[{"x", "^", "5"}]}], "-", 
               RowBox[{"5", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "5"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "expo"}], ")"}], " ", "expo", " ", 
                
                RowBox[{"x", "^", "4"}], " ", "x0"}], "+", 
               RowBox[{"10", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "5"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "4"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "expo"}], ")"}], " ", "expo", " ", 
                
                RowBox[{"x", "^", "3"}], " ", 
                RowBox[{"x0", "^", "2"}]}], "-", 
               RowBox[{"10", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "5"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "4"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "expo"}], ")"}], " ", "expo", " ", 
                
                RowBox[{"x", "^", "2"}], " ", 
                RowBox[{"x0", "^", "3"}]}], "+", 
               RowBox[{"5", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "5"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "4"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "expo"}], ")"}], " ", "expo", " ", 
                "x", " ", 
                RowBox[{"x0", "^", "4"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "5"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "4"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "expo"}], ")"}], " ", 
                RowBox[{"x0", "^", "5"}]}]}], ")"}]}], ",", "\n", 
            "\t\t\t\t\t         ", 
            RowBox[{"(*", " ", 
             RowBox[{"default", ":"}], " ", "*)"}], "\n", 
            "\t\t\t\t\t          ", 
            RowBox[{"SMSPower", "[", 
             RowBox[{"x", ",", "expo"}], "]"}]}], "\n", "\t\t\t\t\t     ", 
           "]"}]}], "\n", "\t\t\t\t    ", "]"}], ",", "\n", "\t\t        ", 
        RowBox[{"SMSPower", "[", 
         RowBox[{"x", ",", "expo"}], "]"}]}], "\n", "\t\t       ", "]"}], 
      "\n", "\t", "]"}], ";"}], "\n", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SMSExpAG", "[", "x_", "]"}], " ", ":=", " ", "\n", 
   RowBox[{"(", "\n", "\t", 
    RowBox[{
     RowBox[{"x0", " ", "=", " ", "100"}], ";", "\n", "\t", 
     RowBox[{"Return", "[", "\n", "\t    ", 
      RowBox[{"SMSIf", "[", 
       RowBox[{
        RowBox[{"x", " ", ">", " ", "x0"}], ",", " ", "\n", "\t\t        ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"For", " ", "arguments", " ", "x"}], ">", "x0"}], ",", " ", 
          RowBox[{
          "we", " ", "use", " ", "a", " ", "linear", " ", "extrapolation"}], 
          ",", " ", 
          RowBox[{"because", " ", 
           RowBox[{"Exp", "[", "x", "]"}], " ", "can", " ", "cause", " ", 
           "memory", " ", "overflow", " ", "quickly"}]}], " ", "*)"}], "\n", 
        "\t\t        ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "[", "\"\<Exp - Finite  extrapolation to high values.nb\>\"", "]"}], 
         " ", "*)"}], "\n", "\t\t        ", 
        RowBox[{
         RowBox[{"Exp", "[", "x0", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x", "-", "x0"}], ")"}]}], ",", "\n", 
        "\t\t        ", 
        RowBox[{"SMSIf", "[", 
         RowBox[{
          RowBox[{"x", "<", 
           RowBox[{"-", "x0"}]}], ",", "\n", "\t\t    \t        ", "0", ",", 
          "\n", "\t\t    \t        ", 
          RowBox[{"(*", " ", 
           RowBox[{"default", ":"}], " ", "*)"}], "\n", "\t\t    \t        ", 
          
          RowBox[{"Exp", "[", "x", "]"}]}], "\n", "\t\t\t         ", "]"}]}], 
       "\n", "\t\t   ", "]"}], "\n", "\t", "]"}], ";"}], "\n", ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SMSPrintDebugLevel", "[", 
    RowBox[{"outputLevel_", ",", "reflevel_", ",", "input_"}], "]"}], " ", ":=",
    " ", "\n", 
   RowBox[{"(", "\n", "\t", 
    RowBox[{
     RowBox[{"If", "[", " ", 
      RowBox[{
       RowBox[{
       "compile\[LetterSpace]with\[LetterSpace]debugging\[LetterSpace]\
conditionals", " ", "==", " ", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SMSIf", "[", 
         RowBox[{
          RowBox[{"outputLevel", ">=", "reflevel"}], ",", "\n", "\t\t\t", 
          RowBox[{"SMSPrintMessage", "[", "input", "]"}]}], "\n", 
         "                     ", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";"}], "\n", ")"}]}], ";"}]}], "Input",
 PageWidth:>Infinity,
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413737500931*^9}, {3.9594144559111023`*^9, 
   3.9594145771414433`*^9}, {3.959414611113225*^9, 3.959414705729742*^9}, {
   3.9594147558803062`*^9, 3.959414970422175*^9}, {3.959415014276359*^9, 
   3.9594151211315536`*^9}, {3.959415154042604*^9, 3.959415217163155*^9}, {
   3.959415251002194*^9, 3.959415510058682*^9}, {3.9594155749785633`*^9, 
   3.9594156917892923`*^9}, {3.959415734369328*^9, 3.9594158717082653`*^9}, {
   3.959417094189485*^9, 3.9594172123084583`*^9}, {3.9598106957923813`*^9, 
   3.9598107354250298`*^9}, {3.959810820128303*^9, 3.95981086766051*^9}, {
   3.959811513771495*^9, 3.959811514575712*^9}, {3.959811563867221*^9, 
   3.959811605018972*^9}, {3.959811646571168*^9, 3.9598116466431293`*^9}, {
   3.959811683059569*^9, 3.9598117029717197`*^9}, {3.959811747655061*^9, 
   3.9598118224208183`*^9}, 3.959811876630066*^9, 3.95981209641258*^9, {
   3.9598121787079906`*^9, 3.9598121917499647`*^9}, 3.959812350986835*^9, {
   3.959812428839019*^9, 3.959812442038455*^9}, 3.959812560931497*^9, {
   3.959812612310029*^9, 3.959812640234902*^9}, {3.9598129841524973`*^9, 
   3.9598130039607553`*^9}, {3.959813086992066*^9, 3.959813302098082*^9}, {
   3.959813364796803*^9, 3.9598133705148697`*^9}, {3.9598137405806313`*^9, 
   3.959813818617402*^9}, {3.959813967449436*^9, 3.959813994224573*^9}, {
   3.959814820678521*^9, 3.959814843903832*^9}, {3.959814906215438*^9, 
   3.9598149300082397`*^9}, {3.9598149989810133`*^9, 3.959815009262825*^9}, {
   3.95985198085357*^9, 3.959852028589221*^9}, 3.959937929219718*^9, {
   3.9599402370500803`*^9, 3.9599404922409554`*^9}, 3.960329636147945*^9},
 CellLabel->
  "In[446]:=",ExpressionUUID->"be8f27fb-1f1e-4eb1-8f89-5686aacb5d94"]
}, Closed]],

Cell[CellGroupData[{

Cell["Documentation of interface and constitutive equations", "Subsection",
 PageWidth:>Infinity,
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413737500931*^9}, {3.9594144559111023`*^9, 
   3.9594145771414433`*^9}, {3.959414611113225*^9, 3.959414705729742*^9}, {
   3.9594147558803062`*^9, 3.959414970422175*^9}, {3.959415014276359*^9, 
   3.9594151211315536`*^9}, {3.959415154042604*^9, 3.959415217163155*^9}, {
   3.959415251002194*^9, 3.959415510058682*^9}, {3.9594155749785633`*^9, 
   3.9594156917892923`*^9}, {3.959415734369328*^9, 3.9594158717082653`*^9}, {
   3.959417094189485*^9, 3.9594172123084583`*^9}, {3.9598106957923813`*^9, 
   3.9598107354250298`*^9}, {3.959810820128303*^9, 3.95981086766051*^9}, {
   3.959811513771495*^9, 3.959811514575712*^9}, {3.959811563867221*^9, 
   3.959811605018972*^9}, {3.959811646571168*^9, 3.9598116466431293`*^9}, {
   3.959811683059569*^9, 3.9598117029717197`*^9}, {3.959811747655061*^9, 
   3.9598118224208183`*^9}, 3.959811876630066*^9, 3.95981209641258*^9, {
   3.9598121787079906`*^9, 3.9598121917499647`*^9}, 3.959812350986835*^9, {
   3.959812428839019*^9, 3.959812442038455*^9}, 3.959812560931497*^9, {
   3.959812612310029*^9, 3.959812640234902*^9}, {3.9598129841524973`*^9, 
   3.9598130039607553`*^9}, {3.959813086992066*^9, 3.959813302098082*^9}, {
   3.959813364796803*^9, 3.9598133705148697`*^9}, {3.9598137405806313`*^9, 
   3.959813818617402*^9}, {3.959813967449436*^9, 3.959813994224573*^9}, {
   3.959814820678521*^9, 3.959814843903832*^9}, {3.959814906215438*^9, 
   3.9598149300082397`*^9}, {3.9598149989810133`*^9, 3.959815009262825*^9}, {
   3.95985198085357*^9, 3.959852028589221*^9}, 3.959937929219718*^9, {
   3.9599402370500803`*^9, 3.9599404922409554`*^9}, {3.960329636147945*^9, 
   3.9603296674272003`*^9}, {3.960335020108156*^9, 
   3.960335027105315*^9}},ExpressionUUID->"84f95789-e88a-4d3e-934d-\
b3caf6872676"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"docu", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"docuText", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<**************************************************************\>\"\
", ",", "\[IndentingNewLine]", "\"\<### Documentation of interface ###\>\"", 
        ",", "\[IndentingNewLine]", "\"\<Input:\>\"", ",", 
        "\[IndentingNewLine]", 
        "\"\< - Deformation gradient (F) as 3x3 component matrix\>\"", ",", 
        "\[IndentingNewLine]", 
        "\"\< - Material parameters (entries of input 'cm'):\>\"", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"KeyValueMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<    \>\"", ",", 
              RowBox[{"ToString", "[", "#2", "]"}], ",", "\"\< = \>\"", ",", 
              RowBox[{"ToString", "[", "#1", "]"}]}], "]"}], ")"}], "&"}], 
          ",", "cm\[LetterSpace]associations"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        "\"\< - History variables (hsvn, all initially zero):\>\"", ",", 
        "\[IndentingNewLine]", "\t", 
        "\"\<    1 = internal hardening variable (alpha)\>\"", ",", 
        "\[IndentingNewLine]", "\t", 
        "\"\<    2:7 = inverse plastic right Cauchy-Green tensor minus unit \
tensor (plasticStrain) (xx,yy,zz,xy,yz,zx)\>\"", ",", "\[IndentingNewLine]", 
        "\t", "\"\<    8 = undamaged acc. plastic strain (H_p_acc)\>\"", ",", 
        "\[IndentingNewLine]", "\t", "\"\<    9 = damage variable (dmg)\>\"", 
        ",", "\[IndentingNewLine]", "\"\<Output:\>\"", ",", 
        "\[IndentingNewLine]", 
        "\"\< - Second Piola-Kirchhoff stress (PK2) in Voigt notation \
(xx,yy,zz,xy,yz,zx)\>\"", ",", "\[IndentingNewLine]", 
        "\"\< - Cauchy stress (Cauchy) in Voigt notation \
(xx,yy,zz,xy,yz,zx)\>\"", ",", "\[IndentingNewLine]", 
        "\"\< - History variables (hsvn1, as above)\>\"", ",", 
        "\[IndentingNewLine]", 
        "\"\< - Eulerian stress-strain tangent matrix (tangent) as 6x6 matrix \
(xx,yy,zz,xy,yz,zx)\>\"", ",", "\[IndentingNewLine]", "\"\<\>\"", ",", 
        "\[IndentingNewLine]", 
        "\"\<### Constitutive equations ###\",\[IndentingNewLine]\t\" Flow \
stress/hardening law: \>\"", ",", "\[IndentingNewLine]", "\t\t", 
        "\"\<  flowStress = yieldStress + hardMod * alpha^PowExpo + \
yieldStressIncr * ( 1 - Exp[ -saturation * alpha^expo ] )\>\"", ",", 
        "\[IndentingNewLine]", "\t", "\"\< Damage law: \>\"", ",", 
        "\[IndentingNewLine]", "\t\t", 
        "\"\<  dmg = DP1 * ( H_p_acc - DP2 )^DExpo >= 0\>\"", ",", 
        "\[IndentingNewLine]", "\t", 
        "\"\< Damage/degradation functions: \>\"", ",", "\[IndentingNewLine]",
         "\t\t", 
        RowBox[{
        "\"\<  damage_function[dmg] = 1 - {DVOL,DDEV,DPLA} * dmg > \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"1.", "*", "dmg\[LetterSpace]fnc\[LetterSpace]minValue"}], 
          "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
        "\"\<   The degradation function is equipped with an exponential \
decay if its value drops below \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"1.", "*", "SPLEX"}], "]"}], "<>", "\"\<.\>\""}], ",", 
        "\[IndentingNewLine]", "\t\t", 
        "\"\<   The degradation function can be adjusted indiviually for the \
degradation of the bulk modulus (DVOL), the shear modulus (DDEV), and the \
flow stress (DPLA).\>\"", ",", "\[IndentingNewLine]", "\"\<\>\"", ",", 
        "\[IndentingNewLine]", "\"\<### Dependencies ###\>\"", ",", "\n", 
        "\t\t   ", 
        "\"\< eig_EW_EB_d_AG: Subroutine 'eig_EW_EB_d_AG' is needed and \
contained in 'eig_EW_EB_d_AG.f'/'eig_EW_EB_d_AG.m'\>\"", ",", 
        "\[IndentingNewLine]", "\t", 
        "\"\< dsyevj3: Subroutine 'dsyevj3' is needed for Fortran in \
eig_EW_EB_d_AG and contained in 'dsyevj3.f'\>\""}], "\[IndentingNewLine]", 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"commentCharacter", " ", "=", " ", 
      RowBox[{"Which", "[", " ", 
       RowBox[{
        RowBox[{"SMSLanguage", "==", "\"\<Fortran\>\""}], ",", " ", 
        "\"\<! \>\"", ",", 
        RowBox[{"SMSLanguage", "==", "\"\<Matlab\>\""}], ",", "\"\<% \>\"", 
        ",", 
        RowBox[{"SMSLanguage", "==", "\"\<C++\>\""}], ",", "\"\<// \>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"commentCharacter", ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "[", "docuText", "]"}]}]}], "\[IndentingNewLine]", 
    ")"}]}], ";"}]], "Input",
 PageWidth:>Infinity,
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413737500931*^9}, {3.9594144559111023`*^9, 
   3.9594145771414433`*^9}, {3.959414611113225*^9, 3.959414705729742*^9}, {
   3.9594147558803062`*^9, 3.959414970422175*^9}, {3.959415014276359*^9, 
   3.9594151211315536`*^9}, {3.959415154042604*^9, 3.959415217163155*^9}, {
   3.959415251002194*^9, 3.959415510058682*^9}, {3.9594155749785633`*^9, 
   3.9594156917892923`*^9}, {3.959415734369328*^9, 3.9594158717082653`*^9}, {
   3.959417094189485*^9, 3.9594172123084583`*^9}, {3.9598106957923813`*^9, 
   3.9598107354250298`*^9}, {3.959810820128303*^9, 3.95981086766051*^9}, {
   3.959811513771495*^9, 3.959811514575712*^9}, {3.959811563867221*^9, 
   3.959811605018972*^9}, {3.959811646571168*^9, 3.9598116466431293`*^9}, {
   3.959811683059569*^9, 3.9598117029717197`*^9}, {3.959811747655061*^9, 
   3.9598118224208183`*^9}, 3.959811876630066*^9, 3.95981209641258*^9, {
   3.9598121787079906`*^9, 3.9598121917499647`*^9}, 3.959812350986835*^9, {
   3.959812428839019*^9, 3.959812442038455*^9}, 3.959812560931497*^9, {
   3.959812612310029*^9, 3.959812640234902*^9}, {3.9598129841524973`*^9, 
   3.9598130039607553`*^9}, {3.959813086992066*^9, 3.959813302098082*^9}, {
   3.959813364796803*^9, 3.9598133705148697`*^9}, {3.9598137405806313`*^9, 
   3.959813818617402*^9}, {3.959813967449436*^9, 3.959813994224573*^9}, {
   3.959814820678521*^9, 3.959814843903832*^9}, {3.959814906215438*^9, 
   3.9598149300082397`*^9}, {3.9598149989810133`*^9, 3.959815009262825*^9}, {
   3.95985198085357*^9, 3.959852028589221*^9}, 3.959937929219718*^9, {
   3.9599402370500803`*^9, 3.9599404922409554`*^9}, {3.960329636147945*^9, 
   3.960329674698928*^9}, {3.960329712411009*^9, 3.960329806396373*^9}, {
   3.9603298439480133`*^9, 3.960329878587343*^9}, {3.96033000229003*^9, 
   3.960330005996366*^9}, {3.960330100980008*^9, 3.9603301558111687`*^9}, {
   3.960330248764358*^9, 3.960330374396246*^9}, {3.960330452545154*^9, 
   3.960330614019062*^9}, {3.960330733456704*^9, 3.9603307417607937`*^9}, {
   3.9603308954752893`*^9, 3.960330940770238*^9}, {3.9603310167840347`*^9, 
   3.960331036254219*^9}, {3.96033129251551*^9, 3.960331332313328*^9}, {
   3.960331601753788*^9, 3.960331621609158*^9}, {3.960331681557188*^9, 
   3.960331721153352*^9}, 3.9603317513777227`*^9, {3.960331940347994*^9, 
   3.9603319406439447`*^9}, {3.960331997805154*^9, 3.960332021983534*^9}, {
   3.960332099210679*^9, 3.9603321004104567`*^9}, 3.960332285764529*^9, 
   3.9603323770687027`*^9, {3.960332407476562*^9, 3.960332434066503*^9}, {
   3.960332494196187*^9, 3.960332528066865*^9}, {3.960333059785152*^9, 
   3.960333159594137*^9}, {3.960333197210218*^9, 3.960333239122015*^9}, {
   3.96033330384137*^9, 3.9603333371632833`*^9}, 3.960333370889484*^9, {
   3.960333460171523*^9, 3.960333558618247*^9}, {3.9603335972082357`*^9, 
   3.9603337089146757`*^9}, {3.960333980194933*^9, 3.960334007861191*^9}, {
   3.9603341628977118`*^9, 3.9603341701483593`*^9}, {3.9603342755719557`*^9, 
   3.960334293651928*^9}, {3.960334349876597*^9, 3.960334351782872*^9}, {
   3.960334466145056*^9, 3.960334490182974*^9}, {3.960334535215912*^9, 
   3.960334716803581*^9}, {3.960335029965321*^9, 3.960335191237125*^9}, {
   3.960335254951335*^9, 3.9603353482937937`*^9}, {3.960335423560564*^9, 
   3.9603354879590473`*^9}, {3.960335665312709*^9, 3.9603356795977373`*^9}, {
   3.96033578454559*^9, 3.9603357882549458`*^9}, {3.9603358443902063`*^9, 
   3.9603358648310337`*^9}, {3.960336185231558*^9, 3.960336213519829*^9}, {
   3.96033759987425*^9, 3.960337714589714*^9}, {3.960337782570077*^9, 
   3.960337951772357*^9}, {3.960337988878849*^9, 3.960338117199068*^9}, {
   3.960338274774386*^9, 3.9603382991563168`*^9}, {3.960338551121546*^9, 
   3.960338558222044*^9}},ExpressionUUID->"1629210f-4b02-491c-a6c2-\
16254bde3500"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"insertDocu", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "NAME\[LetterSpace]FileExtension", ",", "file", ",", "insertStr", ",", 
       "insertLine", ",", "lines", ",", "linesPadded", ",", "newLines"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NAME\[LetterSpace]FileExtension", " ", "=", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SMSLanguage", "==", "\"\<Fortran\>\""}], ",", "\"\<.f\>\"", 
         ",", 
         RowBox[{"SMSLanguage", "==", "\"\<Matlab\>\""}], ",", "\"\<.m\>\"", 
         ",", 
         RowBox[{"SMSLanguage", "==", "\"\<C++\>\""}], ",", "\"\<.cpp\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"file", " ", "=", " ", 
       RowBox[{
       "subroutine\[LetterSpace]NAME", "<>", 
        "NAME\[LetterSpace]FileExtension"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"insertStr", "=", 
       RowBox[{"docu", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"insertLine", "=", "14"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Start", " ", "inserting", " ", "the", " ", "documentation", " ", 
         "text", " ", "at", " ", "this", " ", "line", " ", "number"}], ",", 
        " ", 
        RowBox[{
        "after", " ", "the", " ", "initial", " ", "AceGen", " ", 
         "information"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{"lines", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"file", ",", "\"\<Lines\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newLines", "=", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"lines", ",", 
           RowBox[{"insertLine", "-", "1"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "\"\<\>\"", "}"}], ",", "\[IndentingNewLine]", 
         "insertStr", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\"\<\>\"", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Drop", "[", 
          RowBox[{"lines", ",", "insertLine"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"file", ",", "newLines", ",", "\"\<Lines\>\""}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 PageWidth:>Infinity,
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413737500931*^9}, {3.9594144559111023`*^9, 
   3.9594145771414433`*^9}, {3.959414611113225*^9, 3.959414705729742*^9}, {
   3.9594147558803062`*^9, 3.959414970422175*^9}, {3.959415014276359*^9, 
   3.9594151211315536`*^9}, {3.959415154042604*^9, 3.959415217163155*^9}, {
   3.959415251002194*^9, 3.959415510058682*^9}, {3.9594155749785633`*^9, 
   3.9594156917892923`*^9}, {3.959415734369328*^9, 3.9594158717082653`*^9}, {
   3.959417094189485*^9, 3.9594172123084583`*^9}, {3.9598106957923813`*^9, 
   3.9598107354250298`*^9}, {3.959810820128303*^9, 3.95981086766051*^9}, {
   3.959811513771495*^9, 3.959811514575712*^9}, {3.959811563867221*^9, 
   3.959811605018972*^9}, {3.959811646571168*^9, 3.9598116466431293`*^9}, {
   3.959811683059569*^9, 3.9598117029717197`*^9}, {3.959811747655061*^9, 
   3.9598118224208183`*^9}, 3.959811876630066*^9, 3.95981209641258*^9, {
   3.9598121787079906`*^9, 3.9598121917499647`*^9}, 3.959812350986835*^9, {
   3.959812428839019*^9, 3.959812442038455*^9}, 3.959812560931497*^9, {
   3.959812612310029*^9, 3.959812640234902*^9}, {3.9598129841524973`*^9, 
   3.9598130039607553`*^9}, {3.959813086992066*^9, 3.959813302098082*^9}, {
   3.959813364796803*^9, 3.9598133705148697`*^9}, {3.9598137405806313`*^9, 
   3.959813818617402*^9}, {3.959813967449436*^9, 3.959813994224573*^9}, {
   3.959814820678521*^9, 3.959814843903832*^9}, {3.959814906215438*^9, 
   3.9598149300082397`*^9}, {3.9598149989810133`*^9, 3.959815009262825*^9}, {
   3.95985198085357*^9, 3.959852028589221*^9}, 3.959937929219718*^9, {
   3.9599402370500803`*^9, 3.9599404922409554`*^9}, {3.960329636147945*^9, 
   3.960329674698928*^9}, {3.960329712411009*^9, 3.960329806396373*^9}, {
   3.9603298439480133`*^9, 3.960329878587343*^9}, {3.96033000229003*^9, 
   3.960330005996366*^9}, {3.960330100980008*^9, 3.9603301558111687`*^9}, {
   3.960330248764358*^9, 3.960330374396246*^9}, {3.960330452545154*^9, 
   3.960330614019062*^9}, {3.960330733456704*^9, 3.9603307417607937`*^9}, {
   3.9603308954752893`*^9, 3.960330940770238*^9}, {3.9603310167840347`*^9, 
   3.960331036254219*^9}, {3.96033129251551*^9, 3.960331332313328*^9}, {
   3.960331601753788*^9, 3.960331621609158*^9}, {3.960331681557188*^9, 
   3.960331721153352*^9}, 3.9603317513777227`*^9, {3.960331940347994*^9, 
   3.9603319406439447`*^9}, {3.960331997805154*^9, 3.960332021983534*^9}, {
   3.960332099210679*^9, 3.9603321004104567`*^9}, 3.960332285764529*^9, 
   3.9603323770687027`*^9, {3.960332407476562*^9, 3.960332434066503*^9}, {
   3.960332494196187*^9, 3.960332528066865*^9}, {3.960333059785152*^9, 
   3.960333159594137*^9}, {3.960333197210218*^9, 3.960333239122015*^9}, {
   3.96033330384137*^9, 3.9603333371632833`*^9}, 3.960333370889484*^9, {
   3.960333460171523*^9, 3.960333558618247*^9}, {3.9603335972082357`*^9, 
   3.9603337089146757`*^9}, {3.960333980194933*^9, 3.960334007861191*^9}, {
   3.9603341628977118`*^9, 3.9603341701483593`*^9}, {3.9603342755719557`*^9, 
   3.960334293651928*^9}, {3.960334349876597*^9, 3.960334351782872*^9}, {
   3.960334466145056*^9, 3.9603344887892923`*^9}, {3.960335909381177*^9, 
   3.96033594999026*^9}, {3.960336247393285*^9, 3.960336268979361*^9}, 
   3.9603385479409237`*^9},ExpressionUUID->"9d1a39f2-2ecf-4c29-91ed-\
6f5b0635fa81"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constitutive model", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413737500931*^9}, {3.9594144559111023`*^9, 
   3.9594145771414433`*^9}, {3.959414611113225*^9, 3.959414705729742*^9}, {
   3.9594147558803062`*^9, 3.959414970422175*^9}, {3.959415014276359*^9, 
   3.9594151211315536`*^9}, {3.959415154042604*^9, 3.959415217163155*^9}, {
   3.959415251002194*^9, 3.959415510058682*^9}, {3.9594155749785633`*^9, 
   3.9594156917892923`*^9}, {3.959415734369328*^9, 3.9594158717082653`*^9}, {
   3.959417094189485*^9, 3.9594172123084583`*^9}, {3.9598106957923813`*^9, 
   3.9598107354250298`*^9}, {3.959810820128303*^9, 3.95981086766051*^9}, {
   3.959811513771495*^9, 3.959811514575712*^9}, {3.959811563867221*^9, 
   3.959811605018972*^9}, {3.959811646571168*^9, 3.9598116466431293`*^9}, {
   3.959811683059569*^9, 3.9598117029717197`*^9}, {3.959811747655061*^9, 
   3.9598118224208183`*^9}, 3.959811876630066*^9, 3.95981209641258*^9, {
   3.9598121787079906`*^9, 3.9598121917499647`*^9}, 3.959812350986835*^9, {
   3.959812428839019*^9, 3.959812442038455*^9}, {3.959812560931497*^9, 
   3.959812596686573*^9}},ExpressionUUID->"4ad519fe-68fc-4597-978e-\
10de374fa24f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "plasticStrain\[LetterSpace]accumulated\[LetterSpace]undamaged", "[", 
     "h_", "]"}], " ", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{
      "H\[LetterSpace]p\[LetterSpace]acc\[LetterSpace]k\[LetterSpace]LOCAL", 
       " ", "\[DoubleRightTee]", " ", 
       RowBox[{"H\[LetterSpace]p\[LetterSpace]acc\[LetterSpace]n", "+", 
        RowBox[{
         SqrtBox[
          RowBox[{"2", "/", "3"}]], "*", "h"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "Return", "[", " ", 
       "H\[LetterSpace]p\[LetterSpace]acc\[LetterSpace]k\[LetterSpace]LOCAL", 
       " ", "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plasticHardening", "[", "h_", "]"}], " ", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"damage\[LetterSpace]k", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"damage", "[", "h", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f4\[LetterSpace]LOCAL", "  ", "\[DoubleRightTee]", " ", 
       RowBox[{"damage\[LetterSpace]function", "[", 
        RowBox[{"damage\[LetterSpace]k", ",", "\"\<DPLA\>\"", ",", "cm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "alpha\[LetterSpace]k\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", 
       " ", 
       RowBox[{"alpha\[LetterSpace]n", "+", 
        RowBox[{
         SqrtBox[
          RowBox[{"2", "/", "3"}]], " ", "*", " ", 
         SuperscriptBox["f4\[LetterSpace]LOCAL", "m\[LetterSpace]EFS"], " ", 
         "*", " ", "h"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "Return", "[", " ", "alpha\[LetterSpace]k\[LetterSpace]LOCAL", " ", 
       "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"taudev\[LetterSpace]trial\[LetterSpace]eigensystem", "[", "]"}], 
    " ", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "taudev\[LetterSpace]trial\[LetterSpace]VEC\[LetterSpace]LOCAL", " ", 
       "\[DoubleRightTee]", " ", 
       RowBox[{"shearMod\[LetterSpace]mu", " ", "*", " ", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"2", "*", 
           RowBox[{
           "Log", "[", "EW\[LetterSpace]sqrt\[LetterSpace]trial", "]"}]}], 
          " ", "-", 
          RowBox[{
           RowBox[{"2", "/", "3"}], " ", "*", 
           RowBox[{"Log", "[", "detF", "]"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "Return", "[", 
       "taudev\[LetterSpace]trial\[LetterSpace]VEC\[LetterSpace]LOCAL", "]"}],
       ";"}], "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"evolutionDirection", "[", "taudev\[LetterSpace]VEC_", "]"}], " ",
     ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "evolutionDirection\[LetterSpace]LOCAL", "  ", "\[DoubleRightTee]", " ", 
       FractionBox[
        RowBox[{"taudev\[LetterSpace]VEC", " "}], 
        RowBox[{"SMSMax", "[", " ", 
         RowBox[{
          RowBox[{"SMSSqrt", "[", 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{
             "taudev\[LetterSpace]VEC", "*", "taudev\[LetterSpace]VEC"}], ",",
              "2"}], "]"}], "]"}], ",", "1*^-20"}], " ", "]"}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "evolutionDirection\[LetterSpace]LOCAL", "]"}], 
      ";"}], "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "taudev\[LetterSpace]k\[LetterSpace]eigensystem", "[", " ", "h_", " ", 
     "]"}], " ", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"damage\[LetterSpace]k", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"damage", "[", "h", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f2\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"damage\[LetterSpace]function", "[", 
        RowBox[{"damage\[LetterSpace]k", ",", "\"\<DDEV\>\"", ",", "cm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f4\[LetterSpace]LOCAL", "  ", "\[DoubleRightTee]", " ", 
       RowBox[{"damage\[LetterSpace]function", "[", 
        RowBox[{"damage\[LetterSpace]k", ",", "\"\<DPLA\>\"", ",", "cm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "taudev\[LetterSpace]trial\[LetterSpace]VEC\[LetterSpace]LOCAL", " ", 
       "\[DoubleRightTee]", " ", 
       RowBox[{
       "taudev\[LetterSpace]trial\[LetterSpace]eigensystem", "[", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
      "n\[LetterSpace]dir\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", " ", 
       
       RowBox[{
       "evolutionDirection", "[", 
        "taudev\[LetterSpace]trial\[LetterSpace]VEC\[LetterSpace]LOCAL", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "taudev\[LetterSpace]VEC\[LetterSpace]k\[LetterSpace]LOCAL", " ", 
       "\[DoubleRightTee]", " ", 
       RowBox[{"f2\[LetterSpace]LOCAL", "  ", "*", 
        RowBox[{"(", " ", 
         RowBox[{
         "taudev\[LetterSpace]trial\[LetterSpace]VEC\[LetterSpace]LOCAL", " ",
           "-", " ", 
          RowBox[{"2", "*", "shearMod\[LetterSpace]mu", " ", "*", " ", 
           SuperscriptBox[
            RowBox[{"f4\[LetterSpace]LOCAL", " "}], 
            RowBox[{"-", "m\[LetterSpace]ESP"}]], "*", "h", "*", 
           "n\[LetterSpace]dir\[LetterSpace]LOCAL"}]}], " ", ")"}]}]}], ";", 
      " ", "\[IndentingNewLine]", 
      RowBox[{
      "Return", "[", 
       "taudev\[LetterSpace]VEC\[LetterSpace]k\[LetterSpace]LOCAL", "]"}], 
      ";"}], "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"flowStress", "[", "h_", "]"}], " ", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "alpha\[LetterSpace]k\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", 
       " ", 
       RowBox[{"plasticHardening", "[", "h", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "flow\[LetterSpace]stress\[LetterSpace]k\[LetterSpace]LOCAL", " ", 
       "\[DoubleRightTee]", " ", 
       RowBox[{"yieldStress", " ", "+", " ", 
        RowBox[{"hardMod", " ", "*", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"alpha\[LetterSpace]k\[LetterSpace]LOCAL", "+", "1*^-10"}],
            ")"}], "^", "PowExpo"}]}], "+", 
        RowBox[{"yieldStressIncr", "*", 
         RowBox[{"(", " ", 
          RowBox[{"1", "-", 
           RowBox[{"SMSExpAG", "[", " ", 
            RowBox[{
             RowBox[{"-", "saturation"}], "*", 
             RowBox[{"SMSPowerAG", "[", 
              RowBox[{
              "alpha\[LetterSpace]k\[LetterSpace]LOCAL", ",", "expo"}], 
              "]"}]}], " ", "]"}]}], " ", ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "Return", "[", " ", 
       "flow\[LetterSpace]stress\[LetterSpace]k\[LetterSpace]LOCAL", " ", 
       "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]", " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"yieldFunction", "[", "h_", "]"}], " ", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"damage\[LetterSpace]k", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"damage", "[", "h", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "taudev\[LetterSpace]VEC\[LetterSpace]k\[LetterSpace]LOCAL", " ", 
       "\[DoubleRightTee]", " ", 
       RowBox[{
       "taudev\[LetterSpace]k\[LetterSpace]eigensystem", "[", "h", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"f4\[LetterSpace]LOCAL", "  ", "\[DoubleRightTee]", " ", 
       RowBox[{"damage\[LetterSpace]function", "[", 
        RowBox[{"damage\[LetterSpace]k", ",", "\"\<DPLA\>\"", ",", "cm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "flow\[LetterSpace]stress\[LetterSpace]k\[LetterSpace]LOCAL", " ", 
       "\[DoubleRightTee]", " ", 
       RowBox[{"flowStress", "[", "h", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
      "yieldFnc\[LetterSpace]k\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", 
       
       RowBox[{
        RowBox[{
         SuperscriptBox["f4\[LetterSpace]LOCAL", 
          RowBox[{"-", "m\[LetterSpace]ESP"}]], "*", 
         RowBox[{"SMSSqrt", "[", 
          RowBox[{"Total", "[", 
           RowBox[{
           "taudev\[LetterSpace]VEC\[LetterSpace]k\[LetterSpace]LOCAL", "*", 
            "taudev\[LetterSpace]VEC\[LetterSpace]k\[LetterSpace]LOCAL"}], 
           "]"}], "]"}]}], "-", 
        RowBox[{
         SqrtBox[
          RowBox[{"2", "/", "3"}]], "*", 
         SuperscriptBox["f4\[LetterSpace]LOCAL", "m\[LetterSpace]EFS"], "*", 
         " ", "flow\[LetterSpace]stress\[LetterSpace]k\[LetterSpace]LOCAL"}]}]\
}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "Return", "[", " ", "yieldFnc\[LetterSpace]k\[LetterSpace]LOCAL", " ", 
       "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CauchyStress", "[", "h_", "]"}], " ", ":=", " ", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"damage\[LetterSpace]k", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"damage", "[", "h", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "taudev\[LetterSpace]VEC\[LetterSpace]k\[LetterSpace]LOCAL", " ", 
       "\[DoubleRightTee]", " ", 
       RowBox[{
       "taudev\[LetterSpace]k\[LetterSpace]eigensystem", "[", "h", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"f1\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"damage\[LetterSpace]function", "[", 
        RowBox[{"damage\[LetterSpace]k", ",", "\"\<DVOL\>\"", ",", "cm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"taudev\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "taudev\[LetterSpace]VEC\[LetterSpace]k\[LetterSpace]LOCAL", 
             "\[LeftDoubleBracket]", " ", "iEW", " ", 
             "\[RightDoubleBracket]"}], "*", 
            RowBox[{"EB", " ", "\[LeftDoubleBracket]", " ", 
             RowBox[{"iEW", ",", "i", ",", "j"}], " ", 
             "\[RightDoubleBracket]"}]}], " ", ",", 
           RowBox[{"{", 
            RowBox[{"iEW", ",", "3"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "p\[LetterSpace]tau\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", " ", 
       
       RowBox[{
       "f1\[LetterSpace]LOCAL", "*", " ", "bulkMod\[LetterSpace]kappa", "*", 
        RowBox[{"Log", "[", "detF", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tau\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", " ", 
       RowBox[{
        RowBox[{"p\[LetterSpace]tau\[LetterSpace]LOCAL", "*", 
         RowBox[{"IdentityMatrix", "[", "3", "]"}]}], " ", "+", " ", 
        "taudev\[LetterSpace]LOCAL"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "CauchyStress\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", " ", 
       RowBox[{
        RowBox[{"1", "/", "detF"}], " ", "*", " ", 
        "tau\[LetterSpace]LOCAL"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "Return", "[", " ", "CauchyStress\[LetterSpace]LOCAL", " ", "]"}], 
      ";"}], "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"damage", "[", "h_", "]"}], " ", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Hpacc\[LetterSpace]k\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", 
       " ", 
       RowBox[{
       "plasticStrain\[LetterSpace]accumulated\[LetterSpace]undamaged", "[", 
        "h", "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
      "damage\[LetterSpace]k\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", 
       " ", 
       RowBox[{"SMSMax", "[", " ", 
        RowBox[{"d\[LetterSpace]n", ",", " ", 
         RowBox[{"DP1", "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "Hpacc\[LetterSpace]k\[LetterSpace]LOCAL", " ", "-", " ", "DP2"}],
             ")"}], "^", "DExpo"}]}]}], " ", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "Return", "[", " ", "damage\[LetterSpace]k\[LetterSpace]LOCAL", " ", 
       "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"damage\[LetterSpace]function", "[", 
     RowBox[{"damage_", ",", "type_", ",", "cm_"}], "]"}], " ", ":=", " ", 
    RowBox[{"(", "\n", "    ", 
     RowBox[{
      RowBox[{"dmg\[LetterSpace]saturation", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"cmGet", "[", 
        RowBox[{"type", ",", "cm"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SPLEX", " ", "=", " ", "1*^-2"}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "dmg\[LetterSpace]fnc\[LetterSpace]minValue", " ", "=", " ", "1*^-3"}], 
      ";", "\n", "    ", 
      RowBox[{"dmg\[LetterSpace]fnc", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"SMSIf", "[", 
        RowBox[{
         RowBox[{"damage", "<", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "SPLEX"}], "  ", ")"}], "/", 
           "dmg\[LetterSpace]saturation"}]}], ",", "\n", 
         "                           ", 
         RowBox[{"1", "-", 
          RowBox[{"dmg\[LetterSpace]saturation", "*", "damage"}]}], ",", "\n",
          "                           ", 
         RowBox[{"dmg\[LetterSpace]fnc\[LetterSpace]minValue", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "SPLEX", "-", "dmg\[LetterSpace]fnc\[LetterSpace]minValue"}], 
            ")"}], "*", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "SPLEX", " ", "-", 
               RowBox[{"dmg\[LetterSpace]saturation", "*", "damage"}]}], 
              ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
              "SPLEX", " ", "-", 
               "dmg\[LetterSpace]fnc\[LetterSpace]minValue"}], ")"}]}], 
            "]"}]}]}]}], "]"}]}], ";", "\n", "    ", 
      RowBox[{"Return", "[", "dmg\[LetterSpace]fnc", "]"}], ";"}], "\n", " ", 
     ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RCG\[LetterSpace]plastic\[LetterSpace]inverse", "[", "h_", "]"}],
     " ", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"damage\[LetterSpace]k", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"damage", "[", "h", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f4\[LetterSpace]LOCAL", "  ", "\[DoubleRightTee]", " ", 
       RowBox[{"damage\[LetterSpace]function", "[", 
        RowBox[{"damage\[LetterSpace]k", ",", "\"\<DPLA\>\"", ",", "cm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "taudev\[LetterSpace]trial\[LetterSpace]VEC\[LetterSpace]LOCAL", " ", 
       "\[DoubleRightTee]", " ", 
       RowBox[{
       "taudev\[LetterSpace]trial\[LetterSpace]eigensystem", "[", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
      "n\[LetterSpace]dir\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", " ", 
       
       RowBox[{
       "evolutionDirection", "[", 
        "taudev\[LetterSpace]trial\[LetterSpace]VEC\[LetterSpace]LOCAL", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lame\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"Exp", "[", " ", 
        RowBox[{
         RowBox[{"Log", "[", "EW\[LetterSpace]sqrt\[LetterSpace]trial", "]"}],
          "-", 
         RowBox[{
          SuperscriptBox["f4\[LetterSpace]LOCAL", 
           RowBox[{"-", "m\[LetterSpace]ESP"}]], "*", " ", "h", "*", 
          "n\[LetterSpace]dir\[LetterSpace]LOCAL"}]}], " ", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"be\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{
             "lame\[LetterSpace]LOCAL", "\[LeftDoubleBracket]", " ", "iEW", 
              " ", "\[RightDoubleBracket]"}], "2"], "*", 
            RowBox[{"EB", " ", "\[LeftDoubleBracket]", " ", 
             RowBox[{"iEW", ",", "i", ",", "j"}], " ", 
             "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"iEW", ",", "3"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"iRCGpN1\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", " ", 
       RowBox[{
       "F\[LetterSpace]inv", " ", ".", " ", "be\[LetterSpace]LOCAL", " ", ".",
         " ", 
        RowBox[{"Transpose", "[", "F\[LetterSpace]inv", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", " ", "iRCGpN1\[LetterSpace]LOCAL", " ", "]"}], 
      ";"}], "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "RCG\[LetterSpace]plastic\[LetterSpace]inverse\[LetterSpace]n", "[", 
     "hsvn_", "]"}], " ", ":=", 
    RowBox[{"(", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{"iRCGpN\[LetterSpace]LOCAL", " ", "\[DoubleRightTee]", " ", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "3", "]"}], "+", 
        RowBox[{"vec2ten", "[", 
         RowBox[{
          RowBox[{"hsvGet", "[", 
           RowBox[{"\"\<plasticStrain\>\"", ",", "hsvn"}], "]"}], ",", "1"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "  ", 
      RowBox[{"iRCGpN\[LetterSpace]LOCAL", " ", "\[RightTee]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"SMSDet", "[", "iRCGpN\[LetterSpace]LOCAL", "]"}], "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "3"}], ")"}]}], "*", 
        "iRCGpN\[LetterSpace]LOCAL"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"remove", " ", "possible", " ", "volumetric", " ", "part", " ", 
        RowBox[{"e", ".", "g", ".", " ", "due"}], " ", "to", " ", 
        "remeshing"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", " ", "iRCGpN\[LetterSpace]LOCAL", " ", "]"}], 
      ";"}], "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"get\[LetterSpace]b\[LetterSpace]e\[LetterSpace]trial", "[", 
    RowBox[{"F_", ",", "iRCGp_"}], "]"}], " ", ":=", 
   RowBox[{"(", "\[IndentingNewLine]", "  ", 
    RowBox[{
     RowBox[{
     "b\[LetterSpace]e\[LetterSpace]trial\[LetterSpace]LOCAL", " ", 
      "\[DoubleRightTee]", " ", 
      RowBox[{"F", " ", ".", " ", "iRCGp", " ", ".", " ", 
       RowBox[{"Transpose", "[", "F", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Return", "[", " ", 
      "b\[LetterSpace]e\[LetterSpace]trial\[LetterSpace]LOCAL", " ", "]"}], 
     ";"}], "\[IndentingNewLine]", ")"}]}], ";"}]}], "Input",
 PageWidth:>Infinity,
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413737500931*^9}, {3.9594144559111023`*^9, 
   3.9594145771414433`*^9}, {3.959414611113225*^9, 3.959414705729742*^9}, {
   3.9594147558803062`*^9, 3.959414970422175*^9}, {3.959415014276359*^9, 
   3.9594151211315536`*^9}, {3.959415154042604*^9, 3.959415217163155*^9}, {
   3.959415251002194*^9, 3.959415510058682*^9}, {3.9594155749785633`*^9, 
   3.9594156917892923`*^9}, {3.959415734369328*^9, 3.9594158717082653`*^9}, {
   3.959417094189485*^9, 3.9594172123084583`*^9}, {3.9598106957923813`*^9, 
   3.9598107354250298`*^9}, {3.959810820128303*^9, 3.95981086766051*^9}, {
   3.959811513771495*^9, 3.959811514575712*^9}, {3.959811563867221*^9, 
   3.959811605018972*^9}, {3.959811646571168*^9, 3.9598116466431293`*^9}, {
   3.959811683059569*^9, 3.9598117029717197`*^9}, {3.959811747655061*^9, 
   3.9598118224208183`*^9}, 3.959811876630066*^9, 3.95981209641258*^9, {
   3.9598121787079906`*^9, 3.9598121917499647`*^9}, 3.959812350986835*^9, {
   3.959812428839019*^9, 3.959812442038455*^9}, {3.959812560931497*^9, 
   3.959812571536373*^9}, {3.9598133821850348`*^9, 3.959813390408072*^9}, {
   3.9598134772321*^9, 3.959813477351849*^9}, {3.9598135277327747`*^9, 
   3.959813533995199*^9}, {3.9598135767709703`*^9, 3.9598137022486153`*^9}, {
   3.959813879602598*^9, 3.95981391362088*^9}, {3.959814060266518*^9, 
   3.9598140643768063`*^9}, 3.959814222561781*^9, {3.959814399208709*^9, 
   3.959814401356933*^9}, {3.959814438246422*^9, 3.959814531906048*^9}, {
   3.95981467386552*^9, 3.959814679865528*^9}, {3.959815343244492*^9, 
   3.9598153508029537`*^9}, {3.9598527097043953`*^9, 3.959852711191842*^9}, {
   3.9598527446958637`*^9, 3.95985277192918*^9}, {3.9599405121201553`*^9, 
   3.9599405127602253`*^9}, {3.959941146964666*^9, 3.9599411669914923`*^9}, {
   3.960334770884074*^9, 3.960334836783238*^9}, 3.9603349518232317`*^9, {
   3.960335208966337*^9, 3.9603352441073637`*^9}},
 CellLabel->
  "In[452]:=",ExpressionUUID->"dff0380c-ecab-4b5d-b427-1c0e54e3292f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Main routine", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413740400415*^9}, {3.959413909489298*^9, 
   3.95941417486659*^9}, {3.959414372591585*^9, 3.9594144221712723`*^9}, {
   3.959414586645996*^9, 3.959414593182352*^9}, 3.9594146253223963`*^9, 
   3.959415843327739*^9, {3.959416143490549*^9, 3.95941625492854*^9}, {
   3.9594163902895927`*^9, 3.95941651820294*^9}, {3.959416567314168*^9, 
   3.959417043589189*^9}, {3.9594172360853167`*^9, 3.959417273914694*^9}, 
   3.959810363175156*^9, {3.959810475423625*^9, 3.9598104759755363`*^9}, {
   3.959810645001631*^9, 3.959810692643059*^9}, {3.95981079502703*^9, 
   3.959810815538041*^9}, {3.959811047060267*^9, 3.959811047244068*^9}, {
   3.9598118366043377`*^9, 3.959811862282301*^9}, 3.959812226037002*^9, 
   3.9598122877276*^9, {3.959812759813951*^9, 3.9598127621928*^9}, {
   3.95981302977632*^9, 3.959813034894909*^9}, {3.959813337403297*^9, 
   3.9598133380094347`*^9}, {3.959813412097952*^9, 3.959813438893813*^9}, 
   3.959814689932461*^9, {3.959814791108824*^9, 3.959814813190873*^9}, {
   3.959814869936825*^9, 3.959814890684531*^9}, 3.959815228268755*^9, {
   3.959816172581685*^9, 3.9598161767630997`*^9}, {3.959816237324339*^9, 
   3.9598162443809443`*^9}, {3.959819262402378*^9, 
   3.959819302108152*^9}},ExpressionUUID->"47833c9a-3d12-4e72-8a0b-\
48bce07bb95d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Create", " ", "subroutine", " ", "for", " ", "main", " ", "function"}], 
   " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SMSModule", "[", 
     RowBox[{"subroutine\[LetterSpace]NAME", ",", "\[IndentingNewLine]", 
      RowBox[{"Real", "[", " ", 
       RowBox[{
        RowBox[{"F$$", "[", 
         RowBox[{"3", ",", "3"}], "]"}], ",", " ", 
        RowBox[{"cm$$", "[", "\"\<*\>\"", "]"}], ",", 
        RowBox[{"hsvn$$", "[", "nhsv\[LetterSpace]per\[LetterSpace]QP", "]"}],
         " ", ",", " ", 
        RowBox[{"PK2$$", "[", "6", "]"}], ",", 
        RowBox[{"Cauchy$$", "[", "6", "]"}], ",", 
        RowBox[{
        "hsvn1$$", "[", "nhsv\[LetterSpace]per\[LetterSpace]QP", "]"}], ",", 
        RowBox[{"tangent$$", "[", 
         RowBox[{"6", ",", "6"}], "]"}]}], " ", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Input\>\"", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"F$$", ",", "cm$$", ",", "hsvn$$"}], "}"}]}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Output\>\"", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
        "PK2$$", ",", "Cauchy$$", ",", " ", "hsvn1$$", ",", "tangent$$"}], 
        "}"}]}]}], " ", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"input", " ", 
     RowBox[{"declaration", " ", "/", " ", "copy"}], " ", "Acegen", " ", 
     "variables", " ", "to", " ", "Mathematica", " ", "variables"}], " ", 
    "*)"}], "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"F", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSReal", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"F$$", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"cm", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSReal", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"cm$$", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "100"}], "}"}]}], "]"}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"hsv\[LetterSpace]n", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSReal", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"hsvn$$", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nhsv\[LetterSpace]per\[LetterSpace]QP"}], "}"}]}],
        "]"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Retrieve", " ", "history", " ", "variables"}], " ", "*)"}], 
   "\[IndentingNewLine]", "   ", 
   RowBox[{
    RowBox[{
    "retrieve\[LetterSpace]history\[LetterSpace]variables", "[", 
     "hsv\[LetterSpace]n", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Retrieve", " ", "material", " ", "parameters"}], " ", "*)"}], 
   " ", "\[IndentingNewLine]", "   ", 
   RowBox[{
    RowBox[{
    "retrieve\[LetterSpace]material\[LetterSpace]parameters", "[", "cm", 
     "]"}], ";"}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"debugging\[LetterSpace]level", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"cmGet", "[", 
      RowBox[{"\"\<debugging\>\"", ",", "cm"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"detF", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSDet", "[", "F", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F\[LetterSpace]inv", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSInverse", "[", "F", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F\[LetterSpace]VEC", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSVariables", "[", "F", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SMSPrintDebugLevel", "[", 
     RowBox[{"debugging\[LetterSpace]level", ",", "3", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<deformation gradient=\>\"", ",", "F"}], "}"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Compute", " ", "trial", " ", "elastic", " ", "left", " ", "Cauchy"}], 
     "-", 
     RowBox[{"Green", " ", "strain", " ", "tensor"}]}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{
    "b\[LetterSpace]e\[LetterSpace]trial", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"get\[LetterSpace]b\[LetterSpace]e\[LetterSpace]trial", "[", 
      RowBox[{"F", ",", "iRCGpN"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Link", " ", "eigenvalues"}], ",", " ", 
     RowBox[{"eigenbases", " ", "and", " ", "derivatives"}]}], " ", "*)"}], 
   " ", "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"EW\[LetterSpace]sqrt\[LetterSpace]trial", ",", "EB"}], "}"}], 
     " ", "\[DoubleRightTee]", "  ", 
     RowBox[{"getEIG", "[", "b\[LetterSpace]e\[LetterSpace]trial", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"SMSPrintDebugLevel", "[", 
     RowBox[{"debugging\[LetterSpace]level", ",", "3", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<EW sqrt trial=\>\"", ",", 
        "EW\[LetterSpace]sqrt\[LetterSpace]trial"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", " ", "\[DoubleLeftTee]", " ", 
     RowBox[{"SMSReal", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Phi\[LetterSpace]trial", " ", "\[RightTee]", " ", 
     RowBox[{"yieldFunction", "[", "h", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SMSPrintDebugLevel", "[", 
     RowBox[{"debugging\[LetterSpace]level", ",", "3", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Phi_trial=\>\"", ",", "Phi\[LetterSpace]trial"}], "}"}]}],
      "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SMSIf", "[", " ", 
     RowBox[{"Phi\[LetterSpace]trial", " ", "<", 
      RowBox[{
      "-", "local\[LetterSpace]convergence\[LetterSpace]tolerance\
\[LetterSpace]absolute"}]}], " ", "]"}], ";"}], " ", 
   RowBox[{"(*", " ", "elastic", " ", "*)"}], " ", "\[IndentingNewLine]", 
   "\t", 
   RowBox[{"(*", " ", 
    RowBox[{"History", " ", "remains", " ", "unchanged"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"SMSExport", "[", " ", 
     RowBox[{"hsv\[LetterSpace]n", ",", " ", "hsvn1$$"}], " ", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SMSElse", "[", "]"}], ";"}], 
   RowBox[{"(*", " ", "plastic", " ", "*)"}], " ", "\[IndentingNewLine]", 
   "\t", 
   RowBox[{"(*", " ", 
    RowBox[{"Determine", " ", "unkown", " ", "Lagrange", " ", "multiplier"}], 
    " ", "*)"}], "\[IndentingNewLine]", "\t  ", 
   RowBox[{
    RowBox[{"subr\[LetterSpace]h", " ", "=", " ", 
     RowBox[{"SMSCall", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"subroutine\[LetterSpace]NAME", ",", "\"\<_h_dh\>\""}], "]"}],
        ",", "F", ",", "cm", ",", "hsv\[LetterSpace]n", ",", " ", 
       RowBox[{"Real", "[", 
        RowBox[{"h$$", ",", " ", 
         RowBox[{"dhdF$$", "[", "9", "]"}]}], " ", "]"}], ",", 
       RowBox[{"\"\<System\>\"", "->", "False"}]}], "]"}]}], ";"}], "\t", 
   "\[IndentingNewLine]", "\t  ", 
   RowBox[{
    RowBox[{"dhdF", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSReal", "[", " ", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"dhdF$$", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "9"}], "}"}]}], "]"}], ",", " ", 
       RowBox[{
       "\"\<Subordinate\>\"", " ", "->", " ", "subr\[LetterSpace]h"}]}], " ", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\t  ", 
   RowBox[{
    RowBox[{"h", " ", "\[LeftTee]", " ", 
     RowBox[{"SMSReal", "[", " ", 
      RowBox[{"h$$", ",", " ", 
       RowBox[{"\"\<Subordinate\>\"", "->", "subr\[LetterSpace]h"}], ",", " ", 
       RowBox[{"\"\<Dependency\>\"", "->", " ", 
        RowBox[{"{", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"F\[LetterSpace]VEC", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"dhdF", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "9"}], "}"}]}], "]"}], "}"}]}]}], " ", "]"}]}], 
    " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
   RowBox[{"(*", " ", 
    RowBox[{"Update", " ", "history", " ", "and", " ", "export"}], " ", 
    "*)"}], "\[IndentingNewLine]", "\t  ", 
   RowBox[{
    RowBox[{
    "H\[LetterSpace]p\[LetterSpace]acc\[LetterSpace]k", " ", 
     "\[DoubleRightTee]", " ", 
     RowBox[{
     "plasticStrain\[LetterSpace]accumulated\[LetterSpace]undamaged", "[", 
      "h", "]"}]}], ";", "  ", 
    RowBox[{"SMSExport\[LetterSpace]hsv", "[", 
     RowBox[{
     "H\[LetterSpace]p\[LetterSpace]acc\[LetterSpace]k", ",", " ", 
      "\"\<H_p_acc\>\"", ",", "hsvn1$$"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\t  ", 
   RowBox[{
    RowBox[{"d\[LetterSpace]k", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"damage", "[", "h", "]"}]}], ";", "  ", 
    RowBox[{"SMSExport\[LetterSpace]hsv", "[", 
     RowBox[{"d\[LetterSpace]k", ",", " ", "\"\<dmg\>\"", ",", "hsvn1$$"}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\t  ", 
   RowBox[{
    RowBox[{"alpha\[LetterSpace]k", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"plasticHardening", "[", "h", "]"}]}], ";", "  ", 
    RowBox[{"SMSExport\[LetterSpace]hsv", "[", 
     RowBox[{
     "alpha\[LetterSpace]k", ",", " ", "\"\<alpha\>\"", ",", "hsvn1$$"}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\t  ", 
   RowBox[{
    RowBox[{"SMSExport\[LetterSpace]hsv", "[", " ", 
     RowBox[{
      RowBox[{"ten2vec", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "RCG\[LetterSpace]plastic\[LetterSpace]inverse", "[", "h", "]"}], 
         "-", 
         RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ",", "1"}], "]"}], ",", 
      "\"\<plasticStrain\>\"", ",", "hsvn1$$"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SMSEndIf", "[", "h", "]"}], ";"}], " ", 
   RowBox[{"(*", " ", "plastic", " ", "*)"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Compute", " ", "stresses"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"Cstress", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"CauchyStress", "[", "h", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "  ", 
   RowBox[{
    RowBox[{"PK2", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"detF", "*", 
      RowBox[{"F\[LetterSpace]inv", ".", "Cstress", ".", 
       RowBox[{"Transpose", "[", "F\[LetterSpace]inv", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"SMSPrintDebugLevel", "[", 
     RowBox[{"debugging\[LetterSpace]level", ",", "3", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Cstress=\>\"", ",", "Cstress"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Export", " ", "the", " ", "output", " ", 
     RowBox[{"variables", " ", "/", " ", "copy"}], " ", "mathematica", " ", 
     "variables", " ", "to", " ", "AceGen", " ", "variables"}], "*)"}], 
   "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"SMSExport", "[", " ", 
     RowBox[{
      RowBox[{"ten2vec", "[", 
       RowBox[{"PK2", ",", "1"}], "]"}], ",", " ", "PK2$$"}], " ", "]"}], 
    ";"}], "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"SMSExport", "[", " ", 
     RowBox[{
      RowBox[{"ten2vec", "[", 
       RowBox[{"Cstress", ",", "1"}], "]"}], ",", " ", "Cauchy$$"}], " ", 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Define", " ", "derivatives", " ", 
     RowBox[{"w", ".", "r", ".", "t", ".", " ", "input"}], " ", "variables"}],
     " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"TESTING", "==", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Derivative", " ", "of", " ", "PK2", " ", "wrt", " ", "F"}], 
       " ", "*)"}], " ", "\[IndentingNewLine]", "    ", 
      RowBox[{
       RowBox[{"dPK2dF", " ", "\[DoubleRightTee]", " ", 
        RowBox[{"SMSD", "[", 
         RowBox[{"PK2", ",", "F"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "    ", 
       RowBox[{"dPK2dC", " ", "\[DoubleRightTee]", " ", 
        RowBox[{
        "tangentTransform\[LetterSpace]dSdF\[LetterSpace]to\[LetterSpace]\
dSdC", "[", 
         RowBox[{"dPK2dF", ",", "F"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "    ", 
       RowBox[{"SMSExport", "[", 
        RowBox[{
         RowBox[{"transform4DtoMat", "[", "dPK2dC", "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"tangent$$", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"For", " ", "the", " ", "LS"}], "-", 
          RowBox[{
          "Dyna", " ", "UMAT", " ", "we", " ", "output", " ", "the", " ", 
           "Eulerian", " ", "tangent"}]}], ",", " ", 
         RowBox[{
          RowBox[{"computed", " ", "by", " ", "push"}], "-", 
          RowBox[{"forward", " ", "of", " ", "dPK2dC"}]}]}], " ", "*)"}], " ",
        "\[IndentingNewLine]", "   ", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{"build\[LetterSpace]UMAT\[LetterSpace]LSD", "==", "True"}], 
         ",", "\[IndentingNewLine]", "         ", 
         RowBox[{
          RowBox[{"dsigmadb", " ", "\[DoubleRightTee]", " ", 
           RowBox[{
            RowBox[{"2", "/", "detF"}], "*", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Sum", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"dPK2dC", "[", 
                  RowBox[{"[", 
                   RowBox[{"I", ",", "J", ",", "K", ",", "L"}], "]"}], "]"}], 
                 "*", " ", 
                 RowBox[{"F", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "I"}], "]"}], "]"}], "*", " ", 
                 RowBox[{"F", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "J"}], "]"}], "]"}], "*", " ", 
                 RowBox[{"F", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", "K"}], "]"}], "]"}], "*", " ", 
                 RowBox[{"F", "[", 
                  RowBox[{"[", 
                   RowBox[{"l", ",", "L"}], "]"}], "]"}]}], " ", ",", 
                RowBox[{"{", 
                 RowBox[{"I", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"J", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"K", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"L", ",", "3"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"SMSExport", "[", 
           RowBox[{
            RowBox[{"transform4DtoMat", "[", "dsigmadb", "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"tangent$$", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "6"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "    ", "]"}], ";"}]}], "\[IndentingNewLine]", 
     " ", "]"}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413740400415*^9}, {3.959413909489298*^9, 
   3.95941417486659*^9}, {3.959414372591585*^9, 3.9594144221712723`*^9}, {
   3.959414586645996*^9, 3.959414593182352*^9}, 3.9594146253223963`*^9, 
   3.959415843327739*^9, {3.959416143490549*^9, 3.95941625492854*^9}, {
   3.9594163902895927`*^9, 3.95941651820294*^9}, {3.959416567314168*^9, 
   3.959417043589189*^9}, {3.9594172360853167`*^9, 3.959417273914694*^9}, 
   3.959810363175156*^9, {3.959810475423625*^9, 3.9598104759755363`*^9}, {
   3.959810645001631*^9, 3.959810692643059*^9}, {3.95981079502703*^9, 
   3.959810815538041*^9}, {3.959811047060267*^9, 3.959811047244068*^9}, {
   3.9598118366043377`*^9, 3.959811862282301*^9}, 3.959812226037002*^9, 
   3.9598122877276*^9, {3.959812759813951*^9, 3.9598127621928*^9}, {
   3.95981302977632*^9, 3.959813034894909*^9}, {3.959813337403297*^9, 
   3.9598133380094347`*^9}, {3.959813412097952*^9, 3.959813438893813*^9}, 
   3.959814689932461*^9, {3.959814791108824*^9, 3.959814813190873*^9}, {
   3.959814869936825*^9, 3.959814890684531*^9}, 3.959815228268755*^9, {
   3.959816172581685*^9, 3.9598161767630997`*^9}, {3.959816237324339*^9, 
   3.9598162443809443`*^9}, {3.959819262402378*^9, 3.959819295534079*^9}, {
   3.9598217763606653`*^9, 3.959821806873774*^9}, {3.959821840700058*^9, 
   3.95982184239835*^9}, {3.959826029928082*^9, 3.959826030606415*^9}, {
   3.959852058054818*^9, 3.959852127215687*^9}, {3.959852164631226*^9, 
   3.959852214135523*^9}, {3.959852464368866*^9, 3.95985246666486*^9}, {
   3.959936011122319*^9, 3.959936011474408*^9}, {3.959936421092792*^9, 
   3.959936422275716*^9}, 3.959939872071328*^9, {3.959940519401877*^9, 
   3.959940727761757*^9}, 3.959940763405637*^9, {3.959940803991818*^9, 
   3.959940836069062*^9}, {3.959941176014916*^9, 3.959941182302794*^9}, {
   3.960330749715558*^9, 3.960330752051422*^9}, {3.960331142492223*^9, 
   3.960331147284083*^9}, {3.9603313361944637`*^9, 3.9603313366393538`*^9}},
 CellLabel->
  "In[465]:=",ExpressionUUID->"0f9c4e24-d270-4674-9045-34e63a6228a5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Local residual and its derivative", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413740400415*^9}, {3.959413909489298*^9, 
   3.959414320749301*^9}, {3.959416355749666*^9, 3.95941635737534*^9}, {
   3.959810564513386*^9, 3.959810611282452*^9}, {3.9598107591829023`*^9, 
   3.9598107609307623`*^9}, {3.959810901414548*^9, 3.959811038604723*^9}, {
   3.9598110690520563`*^9, 3.959811151837734*^9}, {3.959811192579166*^9, 
   3.9598114196445847`*^9}, {3.959812360120304*^9, 3.959812360286664*^9}, {
   3.9598133430887957`*^9, 3.959813343738101*^9}, {3.959814577859458*^9, 
   3.959814610010324*^9}, 3.9598146953150673`*^9, {3.9598147526005163`*^9, 
   3.959814756931115*^9}, {3.9598148597204227`*^9, 3.959814861059239*^9}, {
   3.959814952008997*^9, 3.9598149540434237`*^9}, 3.959815361627509*^9, {
   3.959815413612343*^9, 3.9598154251629333`*^9}, 3.959815888564186*^9, {
   3.95982048659429*^9, 3.959820669322394*^9}, {3.959821139630252*^9, 
   3.959821145756675*^9}, {3.9598213826136436`*^9, 3.9598213837797127`*^9}, {
   3.959826841326652*^9, 3.959826842209746*^9}, {3.9598270490188503`*^9, 
   3.959827067089182*^9}, {3.9603361332163267`*^9, 
   3.960336135536626*^9}},ExpressionUUID->"59582599-00ec-4211-9901-\
c1f86162e65b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Compute", " ", "residual", " ", "and", " ", "their", " ", "derivative"}], 
   " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SMSModule", "[", " ", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"subroutine\[LetterSpace]NAME", ",", "\"\<_R_dR\>\""}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Real", "[", " ", 
       RowBox[{
        RowBox[{"F$$", "[", 
         RowBox[{"3", ",", "3"}], "]"}], ",", " ", "h$$", ",", " ", 
        RowBox[{"cm$$", "[", "\"\<*\>\"", "]"}], ",", 
        RowBox[{"hsvn$$", "[", "\"\<*\>\"", "]"}], ",", "R$$", ",", " ", 
        "dRdh$$", ",", " ", 
        RowBox[{"dRdF$$", "[", "9", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Input\>\"", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"F$$", ",", " ", "h$$", ",", " ", "cm$$", ",", "hsvn$$"}], 
        "}"}]}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"\"\<Output\>\"", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"R$$", ",", " ", "dRdh$$", ",", " ", "dRdF$$"}], "}"}]}]}], 
     " ", "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSReal", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"F$$", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cm", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSReal", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"cm$$", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "100"}], "}"}]}], "]"}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hsv\[LetterSpace]n", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSReal", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"hsvn$$", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nhsv\[LetterSpace]per\[LetterSpace]QP"}], "}"}]}],
        "]"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"debugging\[LetterSpace]level", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"cmGet", "[", 
      RowBox[{"\"\<debugging\>\"", ",", "cm"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSReal", "[", "h$$", "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"=", "gamma"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{
    "retrieve\[LetterSpace]history\[LetterSpace]variables", "[", 
     "hsv\[LetterSpace]n", "]"}], ";"}], "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{
    "retrieve\[LetterSpace]material\[LetterSpace]parameters", "[", "cm", 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{
    "b\[LetterSpace]e\[LetterSpace]trial", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"get\[LetterSpace]b\[LetterSpace]e\[LetterSpace]trial", "[", 
      RowBox[{"F", ",", "iRCGpN"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"EW\[LetterSpace]sqrt\[LetterSpace]trial", ",", "EB"}], "}"}], 
     " ", "\[DoubleRightTee]", "  ", 
     RowBox[{"getEIG", "[", "b\[LetterSpace]e\[LetterSpace]trial", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"detF", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSDet", "[", "F", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F\[LetterSpace]VEC", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSVariables", "[", "F", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Compute", " ", "residuals"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"R", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"yieldFunction", "[", "h", "]"}]}], ";"}], "\[IndentingNewLine]",
    "\t", 
   RowBox[{
    RowBox[{"SMSExport", "[", 
     RowBox[{"R", ",", "R$$"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Compute", " ", "derivatives", " ", "of", " ", "residuals"}], " ",
     "*)"}], " ", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"dRdh", "\[DoubleRightTee]", 
     RowBox[{"SMSD", "[", 
      RowBox[{"R", ",", "h"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"SMSExport", "[", 
     RowBox[{"dRdh", ",", " ", "dRdh$$"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SMSPrintDebugLevel", "[", 
     RowBox[{"debugging\[LetterSpace]level", ",", "5", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<R=\>\"", ",", "R"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SMSPrintDebugLevel", "[", 
     RowBox[{"debugging\[LetterSpace]level", ",", "5", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<dRdh=\>\"", ",", "dRdh"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"dRdF", "\[DoubleRightTee]", 
     RowBox[{"SMSD", "[", 
      RowBox[{"R", ",", "F\[LetterSpace]VEC"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"SMSExport", "[", 
     RowBox[{"dRdF", ",", " ", "dRdF$$"}], "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413740400415*^9}, {3.959413909489298*^9, 
   3.959414320749301*^9}, {3.959416355749666*^9, 3.95941635737534*^9}, {
   3.959810564513386*^9, 3.959810611282452*^9}, {3.9598107591829023`*^9, 
   3.9598107609307623`*^9}, {3.959810901414548*^9, 3.959811038604723*^9}, {
   3.9598110690520563`*^9, 3.959811151837734*^9}, {3.959811192579166*^9, 
   3.9598114196445847`*^9}, {3.959812360120304*^9, 3.959812360286664*^9}, {
   3.9598133430887957`*^9, 3.959813343738101*^9}, {3.959814577859458*^9, 
   3.959814610010324*^9}, 3.9598146953150673`*^9, {3.9598147526005163`*^9, 
   3.959814756931115*^9}, {3.9598148597204227`*^9, 3.959814861059239*^9}, {
   3.959814952008997*^9, 3.9598149540434237`*^9}, 3.959815361627509*^9, {
   3.959815413612343*^9, 3.9598154251629333`*^9}, 3.959815888564186*^9, {
   3.95982048659429*^9, 3.959820669322394*^9}, {3.959821139630252*^9, 
   3.959821145756675*^9}, {3.9598213826136436`*^9, 3.9598213837797127`*^9}, {
   3.959826841326652*^9, 3.959826842209746*^9}, {3.9598270490188503`*^9, 
   3.959827061900916*^9}, {3.959936805459071*^9, 3.9599368435365267`*^9}, 
   3.959937541489951*^9},
 CellLabel->
  "In[499]:=",ExpressionUUID->"d2d6aac5-d7a8-4fe5-8853-66495e1c83e9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Solution algorithm", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413740400415*^9}, {3.959413909489298*^9, 
   3.959414320749301*^9}, {3.959416355749666*^9, 3.95941635737534*^9}, {
   3.959810564513386*^9, 3.959810611282452*^9}, {3.9598107591829023`*^9, 
   3.9598107609307623`*^9}, {3.959810901414548*^9, 3.959811038604723*^9}, {
   3.9598110690520563`*^9, 3.959811151837734*^9}, {3.959811192579166*^9, 
   3.9598114196445847`*^9}, {3.959812360120304*^9, 3.959812360286664*^9}, {
   3.9598133430887957`*^9, 3.959813343738101*^9}, {3.959814577859458*^9, 
   3.959814610010324*^9}, 3.9598146953150673`*^9, {3.9598147526005163`*^9, 
   3.959814756931115*^9}, {3.9598148597204227`*^9, 3.959814861059239*^9}, {
   3.959814952008997*^9, 3.9598149540434237`*^9}, 3.959815361627509*^9, {
   3.959815413612343*^9, 3.9598154251629333`*^9}, {3.959815888564186*^9, 
   3.959815914794218*^9}},ExpressionUUID->"2ad4cacb-cfde-4a70-9dbf-\
4adcbe28523a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Compute", " ", "local", " ", "unknowns", " ", "and", " ", "their", " ", 
    "derivatives"}], " ", "*)"}], " ", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"SMSModule", "[", " ", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"subroutine\[LetterSpace]NAME", ",", "\"\<_h_dh\>\""}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Real", "[", " ", 
       RowBox[{
        RowBox[{"F$$", "[", 
         RowBox[{"3", ",", "3"}], "]"}], ",", 
        RowBox[{"cm$$", "[", "\"\<*\>\"", "]"}], ",", 
        RowBox[{"hsvn$$", "[", "\"\<*\>\"", "]"}], ",", " ", "h$$", ",", " ", 
        
        RowBox[{"dhdF$$", "[", "9", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Input\>\"", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"F$$", ",", " ", "cm$$", ",", "hsvn$$"}], "}"}]}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Output\>\"", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"h$$", ",", " ", "dhdF$$"}], "}"}]}]}], " ", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSReal", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"F$$", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cm", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSReal", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"cm$$", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "100"}], "}"}]}], "]"}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hsv\[LetterSpace]n", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSReal", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"hsvn$$", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nhsv\[LetterSpace]per\[LetterSpace]QP"}], "}"}]}],
        "]"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"debugging\[LetterSpace]level", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"cmGet", "[", 
      RowBox[{"\"\<debugging\>\"", ",", "cm"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{
    "retrieve\[LetterSpace]history\[LetterSpace]variables", "[", 
     "hsv\[LetterSpace]n", "]"}], ";"}], "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{
    "retrieve\[LetterSpace]material\[LetterSpace]parameters", "[", "cm", 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"detF", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSDet", "[", "F", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F\[LetterSpace]VEC", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSVariables", "[", "F", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{
    "b\[LetterSpace]e\[LetterSpace]trial", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"get\[LetterSpace]b\[LetterSpace]e\[LetterSpace]trial", "[", 
      RowBox[{"F", ",", "iRCGpN"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"EW\[LetterSpace]sqrt\[LetterSpace]trial", ",", "EB"}], "}"}], 
     " ", "\[DoubleRightTee]", "  ", 
     RowBox[{"getEIG", "[", "b\[LetterSpace]e\[LetterSpace]trial", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Initialise", " ", "unknowns", " ", "to", " ", "zero"}], " ", 
    "*)"}], "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"h", " ", "\[DoubleLeftTee]", " ", 
     RowBox[{"SMSReal", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Loop", " ", "to", " ", "find", " ", "the", " ", "unknown", " ", 
     "Lagrange", " ", "multiplier"}], " ", "*)"}], " ", "\[IndentingNewLine]",
    "  ", 
   RowBox[{
    RowBox[{"SMSDo", "[", 
     RowBox[{
     "NR", ",", "1", ",", "n\[LetterSpace]subiterations", ",", "1", ",", 
      RowBox[{"{", "h", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"yieldFnc\[LetterSpace]k", " ", "\[DoubleRightTee]", " ", 
      RowBox[{"yieldFunction", "[", "h", "]"}]}], ";", "\[IndentingNewLine]", 
     " ", 
     RowBox[{"dPhidh", " ", "\[RightTee]", " ", 
      RowBox[{"SMSD", "[", 
       RowBox[{"yieldFnc\[LetterSpace]k", ",", "h"}], "]"}]}], ";"}], " ", 
    "*)"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"subr\[LetterSpace]R", " ", "=", " ", 
     RowBox[{"SMSCall", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"subroutine\[LetterSpace]NAME", ",", "\"\<_R_dR\>\""}], "]"}],
        ",", "F", ",", "h", ",", "cm", ",", "hsv\[LetterSpace]n", ",", " ", 
       RowBox[{"Real", "[", 
        RowBox[{"R$$", ",", " ", "dRdh$$", ",", " ", 
         RowBox[{"dRdF$$", "[", "9", "]"}]}], " ", "]"}], ",", 
       RowBox[{"\"\<System\>\"", "->", "False"}]}], "]"}]}], ";"}], "\t", 
   "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"dPhidh", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSReal", "[", 
      RowBox[{"dRdh$$", ",", " ", 
       RowBox[{
       "\"\<Subordinate\>\"", " ", "->", " ", "subr\[LetterSpace]R"}]}], " ", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"dRdF", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSReal", "[", " ", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"dRdF$$", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "9"}], "}"}]}], "]"}], ",", " ", 
       RowBox[{
       "\"\<Subordinate\>\"", " ", "->", " ", "subr\[LetterSpace]R"}]}], " ", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"yieldFnc\[LetterSpace]k", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSReal", "[", " ", 
      RowBox[{"R$$", ",", " ", 
       RowBox[{"\"\<Subordinate\>\"", "->", "subr\[LetterSpace]R"}], ",", " ", 
       RowBox[{"\"\<Dependency\>\"", "->", " ", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"F\[LetterSpace]VEC", "[", 
               RowBox[{"[", "k", "]"}], "]"}], ",", 
              RowBox[{"dRdF", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "9"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"h", ",", "dPhidh"}], "}"}]}], " ", "}"}]}]}], "]"}]}], 
    " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"delta\[LetterSpace]h", " ", "\[DoubleRightTee]", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", " ", "1"}], "/", "dPhidh"}], "  ", "*", " ", 
      "yieldFnc\[LetterSpace]k"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"SMSPrintDebugLevel", "[", 
     RowBox[{"debugging\[LetterSpace]level", ",", "4", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<NR=\>\"", ",", "NR", ",", "\"\<: yieldFnc_k=\>\"", ",", 
        "yieldFnc\[LetterSpace]k", ",", "\"\<; dPhidh=\>\"", ",", "dPhidh", 
        ",", "\"\<; delta_h=\>\"", ",", "delta\[LetterSpace]h"}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Line", " ", "search", " ", "to", " ", "determine", " ", "the", " ", 
     "step", " ", "size", " ", "reduction", " ", "factor"}], " ", "*)"}], " ",
    "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"SMSDo", "[", 
     RowBox[{
     "iNY", ",", "0", ",", 
      "n\[LetterSpace]iterations\[LetterSpace]lineSearch", ",", "1"}], "]"}], 
    ";"}], "\[IndentingNewLine]", "\t\t", 
   RowBox[{
    RowBox[{"reduction\[LetterSpace]basis", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"SMSIf", "[", 
      RowBox[{
       RowBox[{"iNY", "<", "5"}], ",", "2", ",", "4"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\t\t", 
   RowBox[{
    RowBox[{"reduction", " ", "\[DoubleRightTee]", " ", 
     SuperscriptBox["reduction\[LetterSpace]basis", 
      RowBox[{"-", 
       RowBox[{"SMSReal", "[", "iNY", "]"}]}]]}], " ", ";"}], 
   "\[IndentingNewLine]", "\t\t", 
   RowBox[{
    RowBox[{"h\[LetterSpace]Test", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"h", " ", "+", 
      RowBox[{"reduction", "*", " ", "delta\[LetterSpace]h"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\t\t", 
   RowBox[{
    RowBox[{"yieldFnc\[LetterSpace]Test", " ", "\[DoubleRightTee]", " ", 
     RowBox[{"yieldFunction", "[", "h\[LetterSpace]Test", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
   RowBox[{
    RowBox[{"SMSIf", "[", " ", 
     RowBox[{
      RowBox[{"yieldFnc\[LetterSpace]Test", "<=", " ", 
       RowBox[{"1.01", "*", "yieldFnc\[LetterSpace]k"}]}], " ", "||", " ", 
      RowBox[{
      "yieldFnc\[LetterSpace]Test", " ", "<=", " ", 
       "local\[LetterSpace]convergence\[LetterSpace]tolerance\[LetterSpace]\
absolute"}]}], " ", "]"}], ";"}], "\[IndentingNewLine]", "\t\t\t", 
   RowBox[{
    RowBox[{"SMSBreak", "[", "]"}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"finish", " ", "liS"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   "\t\t", 
   RowBox[{
    RowBox[{"SMSEndIf", "[", "]"}], ";"}], "\[IndentingNewLine]", "\t\t", 
   RowBox[{
    RowBox[{"SMSIf", "[", " ", 
     RowBox[{
      RowBox[{"iNY", ">=", 
       RowBox[{
       "n\[LetterSpace]iterations\[LetterSpace]lineSearch", "-", "1"}]}], ",",
       "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{
       RowBox[{"SMSPrintDebugLevel", "[", 
        RowBox[{"debugging\[LetterSpace]level", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
          "subroutine\[LetterSpace]NAME", ",", 
           "\"\<<< Failed to find admissible solution. yieldFnc_k=\>\"", ",", 
           "yieldFnc\[LetterSpace]k", ",", "\"\<; dPhidh=\>\"", ",", "dPhidh",
            ",", "\"\<; delta_h=\>\"", ",", "delta\[LetterSpace]h"}], "}"}]}],
         "]"}], ";", "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{"SMSBreak", "[", "]"}]}]}], 
     RowBox[{"(*", " ", 
      RowBox[{"break", " ", "out", " ", "of", " ", "line", " ", "search"}], 
      " ", "*)"}], " ", "\[IndentingNewLine]", "\t\t       ", "]"}], ";"}], 
   "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"SMSEndDo", "[", "reduction", "]"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\t", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Apply", " ", "the", " ", "possibly", " ", "reduced", " ", "increment"}], 
    " ", "*)"}], "\[IndentingNewLine]", "\t  ", 
   RowBox[{
    RowBox[{"h", " ", "\[LeftTee]", " ", 
     RowBox[{"h", "+", 
      RowBox[{"reduction", "*", "delta\[LetterSpace]h"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\t  ", 
   RowBox[{"SMSPrintDebugLevel", "[", 
    RowBox[{"debugging\[LetterSpace]level", ",", "4", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<h=\>\"", ",", "h"}], "}"}]}], "]"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\t", 
   RowBox[{"(*", " ", 
    RowBox[{"Check", " ", "for", " ", "convergence"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\t  ", 
   RowBox[{
    RowBox[{"SMSIf", "[", " ", 
     RowBox[{
      RowBox[{"yieldFunction", "[", "h", "]"}], " ", "<=", 
      "local\[LetterSpace]convergence\[LetterSpace]tolerance\[LetterSpace]\
absolute"}], "  ", "]"}], ";"}], "\[IndentingNewLine]", "\t\t", 
   RowBox[{
    RowBox[{"SMSExport", "[", " ", 
     RowBox[{"h", ",", " ", "h$$"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\t\t", 
   RowBox[{
    RowBox[{"SMSExport", "[", " ", 
     RowBox[{
      RowBox[{"SMSD", "[", 
       RowBox[{"h", ",", "F\[LetterSpace]VEC"}], "]"}], ",", " ", "dhdF$$"}], 
     "]"}], ";"}], "\[IndentingNewLine]", "\t\t", 
   RowBox[{
    RowBox[{"SMSBreak", "[", "]"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Leave", " ", "local", " ", "NR", " ", "iterations"}], ",", " ", 
     
     RowBox[{"because", " ", "we", " ", "converged"}]}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", "\t  ", 
   RowBox[{
    RowBox[{"SMSEndIf", "[", "]"}], ";"}], "\[IndentingNewLine]", "\t  ", 
   RowBox[{
    RowBox[{"SMSIf", "[", 
     RowBox[{
      RowBox[{"NR", ">=", 
       RowBox[{"n\[LetterSpace]subiterations", "-", "1"}]}], ",", 
      "\[IndentingNewLine]", "\t\t  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"error\[LetterSpace]termination", "[", "]"}], ";"}], "*)"}], 
      " ", "\[IndentingNewLine]", "\t\t  ", 
      RowBox[{
       RowBox[{"SMSExport", "[", " ", 
        RowBox[{
         RowBox[{"SMSReal", "[", "0", "]"}], ",", " ", "h$$"}], "]"}], ";", 
       "\[IndentingNewLine]", "\t\t  ", 
       RowBox[{"SMSExport", "[", " ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "9"}], "}"}]}], "]"}], ",", " ", "dhdF$$"}], 
        "]"}], ";", "\[IndentingNewLine]", "\t\t  ", 
       RowBox[{"SMSBreak", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "\t\t  ", "]"}], ";"}], "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"SMSEndDo", "[", "]"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"end", " ", "NR"}], " ", "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 PageWidth:>Infinity,
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413740400415*^9}, {3.959413909489298*^9, 
   3.959414320749301*^9}, {3.959416355749666*^9, 3.95941635737534*^9}, {
   3.959810564513386*^9, 3.959810611282452*^9}, {3.9598107591829023`*^9, 
   3.9598107609307623`*^9}, {3.959810901414548*^9, 3.959811038604723*^9}, {
   3.9598110690520563`*^9, 3.959811151837734*^9}, {3.959811192579166*^9, 
   3.9598114196445847`*^9}, {3.959812360120304*^9, 3.959812360286664*^9}, {
   3.9598133430887957`*^9, 3.959813343738101*^9}, {3.959814577859458*^9, 
   3.959814610010324*^9}, 3.9598146953150673`*^9, {3.9598147526005163`*^9, 
   3.959814756931115*^9}, {3.9598148597204227`*^9, 3.959814861059239*^9}, {
   3.959814952008997*^9, 3.9598149540434237`*^9}, 3.959815361627509*^9, {
   3.959815413612343*^9, 3.9598154251629333`*^9}, {3.959815888564186*^9, 
   3.959815903118946*^9}, {3.9598206906112013`*^9, 3.959820841722184*^9}, {
   3.959820965982472*^9, 3.959820968377448*^9}, {3.959821151468813*^9, 
   3.959821156340838*^9}, {3.9598213995487347`*^9, 3.9598214381408253`*^9}, 
   3.959821698029996*^9, {3.959826855530649*^9, 3.959826864090395*^9}, {
   3.959936079553179*^9, 3.9599362149525537`*^9}, {3.959936399282544*^9, 
   3.959936402403121*^9}, {3.959936451578191*^9, 3.959936540554202*^9}, 
   3.959936869957752*^9, {3.9599398755685577`*^9, 3.959939880658968*^9}, {
   3.959939914110133*^9, 3.959939915110373*^9}, {3.959940870114313*^9, 
   3.9599408736760883`*^9}, {3.959940906628356*^9, 3.959941025809443*^9}, {
   3.959941057273855*^9, 3.959941106862969*^9}, {3.959941190143342*^9, 
   3.959941234118517*^9}},
 CellLabel->
  "In[519]:=",ExpressionUUID->"cd92092e-565f-478b-93a7-5a1700f27253"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"write", " ", "output", " ", "file"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"TESTING", "==", "False"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
        "name", " ", "of", " ", "the", " ", "created", " ", "output"}], "-", 
        RowBox[{"file", " ", "can", " ", "be", " ", "specified"}]}], " ", ",", 
       RowBox[{"\"\<LocalAuxiliaryVariables\>\"", " ", "->", " ", 
        RowBox[{
        "True", " ", "is", " ", "a", " ", "command", " ", "to", " ", 
         "exclude", " ", "the", " ", "array", " ", "v", " ", "of", " ", "the",
          " ", "list", " ", "of", " ", "input", " ", "and", " ", "output", 
         " ", "parameters", " ", "of", " ", "the", " ", "created", " ", 
         "subroutine"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SMSWrite", "[", 
       RowBox[{"subroutine\[LetterSpace]NAME", ",", 
        RowBox[{"\"\<LocalAuxiliaryVariables\>\"", " ", "->", " ", "True"}]}],
        "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"SMSLanguage", "==", "\"\<Matlab\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cmd", "=", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
           "\"\<python3 fixAceGenMatlabBugs.py \>\"", ",", 
            "subroutine\[LetterSpace]NAME", ",", "\"\<.m\>\""}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"RunProcess", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<bash\>\"", ",", "\"\<-c\>\"", ",", "cmd"}], "}"}], 
          "]"}]}]}], " ", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"insertDocu", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "print", " ", "file", " ", "on", " ", "screen", " ", 
        "\[IndentingNewLine]", "NAME\[LetterSpace]FileExtension"}], " ", "=", 
       " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"SMSLanguage", "==", "\"\<Fortran\>\""}], ",", "\"\<.f\>\"", 
         ",", 
         RowBox[{"SMSLanguage", "==", "\"\<Matlab\>\""}], ",", "\"\<.m\>\"", 
         ",", 
         RowBox[{"SMSLanguage", "==", "\"\<C++\>\""}], ",", "\"\<.cpp\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FilePrint", "[", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
        "subroutine\[LetterSpace]NAME", ",", 
         "NAME\[LetterSpace]FileExtension"}], "]"}], "]"}]}], "*)"}], 
    "\[IndentingNewLine]", "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8055170349481487`*^9, 3.8055172434509287`*^9}, {
   3.805522756054459*^9, 3.805523020911359*^9}, {3.805523086946496*^9, 
   3.8055234118242407`*^9}, 3.8055234769464827`*^9, {3.8055235395160217`*^9, 
   3.805523544045752*^9}, {3.805523633558035*^9, 3.805523634343767*^9}, {
   3.805523667407618*^9, 3.8055236923411303`*^9}, {3.805523734355294*^9, 
   3.805523766144617*^9}, {3.806050805854116*^9, 3.806050834618264*^9}, {
   3.806050898160262*^9, 3.806050903227672*^9}, {3.8060509868530416`*^9, 
   3.806051078609476*^9}, {3.806751836784066*^9, 3.80675225028258*^9}, {
   3.806752296105538*^9, 3.8067524018269567`*^9}, {3.806753503631459*^9, 
   3.806753779681016*^9}, {3.806753813497026*^9, 3.806753813720134*^9}, {
   3.806753846968646*^9, 3.8067541798443527`*^9}, {3.806754218426395*^9, 
   3.806754218897821*^9}, {3.8067543690777273`*^9, 3.806754406098246*^9}, {
   3.8067546276380787`*^9, 3.806754639501636*^9}, {3.8067558379756603`*^9, 
   3.806755844774032*^9}, {3.8067562502492437`*^9, 3.806756261004057*^9}, {
   3.806756415617284*^9, 3.80675642519681*^9}, {3.806756831715848*^9, 
   3.806756833712741*^9}, {3.806756914948704*^9, 3.806756915553116*^9}, {
   3.8067572896912622`*^9, 3.806757290375372*^9}, {3.806757601560789*^9, 
   3.8067576099254293`*^9}, {3.806803428476458*^9, 3.8068034576207457`*^9}, {
   3.80680350308498*^9, 3.8068035041262617`*^9}, {3.806803595239105*^9, 
   3.806803606397317*^9}, {3.8068036553874683`*^9, 3.806803665410039*^9}, {
   3.8068037395699167`*^9, 3.80680380084375*^9}, {3.806805065145648*^9, 
   3.806805068824222*^9}, {3.806835804789747*^9, 3.8068358065737047`*^9}, {
   3.8070036533314857`*^9, 3.807003994540765*^9}, {3.8070040676494303`*^9, 
   3.807004352704596*^9}, {3.807004418921929*^9, 3.8070044198738203`*^9}, {
   3.807004536140424*^9, 3.80700466867095*^9}, {3.807004714022187*^9, 
   3.807004745306436*^9}, {3.807004810033965*^9, 3.8070048471924973`*^9}, {
   3.80700489357376*^9, 3.807004939292639*^9}, {3.8070050368896637`*^9, 
   3.807005111029245*^9}, {3.8070059978328743`*^9, 3.807006001368207*^9}, {
   3.877480939526758*^9, 3.8774809460621023`*^9}, {3.8775136314548197`*^9, 
   3.8775136469740753`*^9}, {3.877513762187553*^9, 3.87751376515099*^9}, 
   3.877514800865048*^9, {3.877517387553995*^9, 3.877517395538245*^9}, {
   3.877520434853314*^9, 3.877520437589541*^9}, {3.877660535887978*^9, 
   3.877660536321463*^9}, {3.877665520367144*^9, 3.877665522878677*^9}, {
   3.87776302079294*^9, 3.877763027544154*^9}, 3.8777638430313253`*^9, {
   3.878201795621043*^9, 3.878201925387907*^9}, {3.884151491590219*^9, 
   3.8841514957720137`*^9}, {3.892108101029443*^9, 3.892108110340908*^9}, {
   3.9594137068972483`*^9, 3.959413740400415*^9}, {3.959413909489298*^9, 
   3.959414190567184*^9}, 3.959813075032879*^9, 3.959816248852085*^9, {
   3.959816682743651*^9, 3.959816683413624*^9}, {3.959817657225231*^9, 
   3.959817657386211*^9}, {3.959817716442458*^9, 3.9598177866269608`*^9}, 
   3.9598213399704647`*^9, 3.959827530786188*^9, {3.9603313870235567`*^9, 
   3.960331407890645*^9}, {3.960331486226831*^9, 3.96033158798733*^9}, {
   3.960331666450844*^9, 3.960331672298811*^9}, 3.960331742035844*^9, 
   3.960331824168599*^9, {3.960332166821357*^9, 3.960332173548945*^9}, 
   3.960333406992807*^9},
 CellLabel->
  "In[557]:=",ExpressionUUID->"48a98992-a12b-4b4d-bb26-8456fff6f7b9"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TemplateBox[{
       StyleBox["\"File: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], "\"multiPD.m\"", 
       StyleBox["\"  Size: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], "127610", 
       StyleBox["\"  Time: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], "112"},
      "RowDefault"]},
    {
     TagBox[GridBox[{
        {
         StyleBox["\<\"Method\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], 
         StyleBox["\<\"multiPD\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontColor->RGBColor[0, 0, 1]], 
         StyleBox["\<\"multiPD_R_dR\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontColor->RGBColor[0, 0, 1]], 
         StyleBox["\<\"multiPD_h_dh\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox["\<\"No.Formulae\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], "1685", "186", "160"},
        {
         StyleBox["\<\"No.Leafs\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], "43929", "3093", "3326"}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Center}}},
       GridBoxDividers->{"Columns" -> {True, True}},
       GridBoxFrame->{"ColumnsIndexed" -> {{{1, -1}, {1, -1}} -> True}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Rows" -> {True, True}},
   GridBoxFrame->{"Columns" -> False, "Rows" -> False},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Print",
 CellChangeTimes->{3.960334997226853*^9, 3.960335334052702*^9, 
  3.9603354243923903`*^9, 3.960335526604947*^9, 3.960335718453136*^9, 
  3.9603358268207293`*^9, 3.960336139258369*^9, 3.96033783036926*^9, 
  3.9603380672198267`*^9, 3.960338234773542*^9, 3.9603384330278187`*^9},
 CellLabel->
  "During evaluation of \
In[557]:=",ExpressionUUID->"0b0761f3-505c-4f98-b7b8-c46b8ee18f8f"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1693, 1144},
WindowMargins->{{Automatic, 1}, {Automatic, 27}},
TaggingRules->Association["TryRealOnly" -> False],
InputAutoReplacements->{
 "ld" -> "\[DoubleRightTee]", "ls" -> "\[RightTee]", "rd" -> 
  "\[DoubleLeftTee]", "rs" -> "\[LeftTee]", "dbl" -> "\[LeftDoubleBracket]", 
  "dbr" -> "\[RightDoubleBracket]", "->" -> "\[Rule]", "_" -> 
  "\[LetterSpace]", "co" -> "(*", "cc" -> "*)", "lcb" -> "{", "rcb" -> "}", 
  "lsb" -> "[", "rsb" -> "]"},
FrontEndVersion->"12.3 for Linux x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8885aaff-9608-4063-a90c-9f9c298f5817"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 319, 7, 98, "Title",ExpressionUUID->"f9299cf0-f2f0-4543-a424-0cdfff049f23"],
Cell[902, 31, 576, 15, 246, "Abstract",ExpressionUUID->"3a924117-3a5d-4d40-88e5-e75bd695b5fd"],
Cell[CellGroupData[{
Cell[1503, 50, 2267, 48, 119, "Input",ExpressionUUID->"2cfd6946-f75b-418a-99fe-c683b8640bec"],
Cell[3773, 100, 3121, 53, 42, "Output",ExpressionUUID->"6ae4786b-ffc8-4f2f-80b7-70933f6d8d77"]
}, Open  ]],
Cell[6909, 156, 9133, 174, 516, "Input",ExpressionUUID->"8844cf92-f4b2-4d5e-bb00-3725bcd312d2"],
Cell[CellGroupData[{
Cell[16067, 334, 4019, 55, 54, "Subsection",ExpressionUUID->"f56c3587-e218-4d67-a0ad-c721c7b1ecab",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[20089, 391, 33584, 858, 1838, "Input",ExpressionUUID->"be90e029-048d-4071-b674-a84c868cd0c3",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}]
}, Closed]],
Cell[CellGroupData[{
Cell[53710, 1254, 3974, 54, 38, "Subsection",ExpressionUUID->"0454cc4c-66d4-447d-b785-fbbe70c33849",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[57687, 1310, 10254, 187, 1000, "Input",ExpressionUUID->"5cfe49fc-c21e-4553-8c92-5059d1a5995c",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[67978, 1502, 4345, 59, 54, "Subsection",ExpressionUUID->"b453eeab-ffc4-4732-b094-4077c61924aa",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[72326, 1563, 10930, 218, 867, "Input",ExpressionUUID->"20099fcd-bee4-4da4-a920-366ad25b3ba4",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}]
}, Closed]],
Cell[CellGroupData[{
Cell[83293, 1786, 4329, 59, 38, "Subsection",ExpressionUUID->"727bb64a-60ce-411e-9846-f00838950c1b",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.}],
Cell[87625, 1847, 24747, 549, 1637, "Input",ExpressionUUID->"be8f27fb-1f1e-4eb1-8f89-5686aacb5d94",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.}]
}, Closed]],
Cell[CellGroupData[{
Cell[112409, 2401, 4606, 63, 38, "Subsection",ExpressionUUID->"84f95789-e88a-4d3e-934d-b3caf6872676",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.}],
Cell[117018, 2466, 11305, 182, 779, "Input",ExpressionUUID->"1629210f-4b02-491c-a6c2-16254bde3500",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.}],
Cell[128326, 2650, 8453, 139, 339, "Input",ExpressionUUID->"9d1a39f2-2ecf-4c29-91ed-6f5b0635fa81",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[136816, 2794, 3900, 53, 54, "Subsection",ExpressionUUID->"4ad519fe-68fc-4597-978e-10de374fa24f",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[140719, 2849, 24604, 535, 2354, "Input",ExpressionUUID->"dff0380c-ecab-4b5d-b427-1c0e54e3292f",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}]
}, Closed]],
Cell[CellGroupData[{
Cell[165360, 3389, 4067, 56, 38, "Subsection",ExpressionUUID->"47833c9a-3d12-4e72-8a0b-48bce07bb95d",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.}],
Cell[169430, 3447, 21289, 465, 1661, "Input",ExpressionUUID->"0f9c4e24-d270-4674-9045-34e63a6228a5",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.}]
}, Closed]],
Cell[CellGroupData[{
Cell[190756, 3917, 3963, 54, 38, "Subsection",ExpressionUUID->"59582599-00ec-4211-9901-c1f86162e65b",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.}],
Cell[194722, 3973, 9548, 196, 801, "Input",ExpressionUUID->"d2d6aac5-d7a8-4fe5-8853-66495e1c83e9",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.}]
}, Closed]],
Cell[CellGroupData[{
Cell[204307, 4174, 3673, 50, 38, "Subsection",ExpressionUUID->"2ad4cacb-cfde-4a70-9dbf-4adcbe28523a",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[207983, 4226, 17976, 392, 1571, "Input",ExpressionUUID->"cd92092e-565f-478b-93a7-5a1700f27253",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[225996, 4623, 6146, 112, 357, "Input",ExpressionUUID->"48a98992-a12b-4b4d-bb26-8456fff6f7b9"],
Cell[232145, 4737, 3280, 81, 86, "Print",ExpressionUUID->"0b0761f3-505c-4f98-b7b8-c46b8ee18f8f"]
}, Open  ]]
}, Open  ]]
}
]
*)

